<document xmlns="http://cnx.rice.edu/cnxml" xmlns:m="http://www.w3.org/1998/Math/MathML" xmlns:md="http://cnx.rice.edu/mdml">
  <title>Elements of Markov Sequences</title>
  <metadata>
  <md:content-id>m23824</md:content-id><md:title>Elements of Markov Sequences</md:title>
  <md:abstract>We show that the fundamental Markov property for a sequence is an expression of conditional independence of “past” and “future," given the “present.” The essential Chapman-Kolmogorov equation is seen as a consequence. In the usual time-homogeneous case with finite state space, the Chapman-Kolmogorov equation leads to the algebraic formulation that is widely studied at a variety of levels of mathematical sophistication. We sketch some of the more common results. This should provide a probabilistic perspective for a more complete study of the algebraic analysis.
We model a system characterized by a sequence of states taken on at discrete instants, which we call transition times. At each transition time, there is either a change to a new state or a renewal of the state immediately before the transition. Each state is maintained unchanged during the period or stage between transitions. At any transition time, the move to the next state is characterized by a conditional transition probability distribution. We suppose the system is memoryless in the sense that the transition probabilities are dependent upon the current state (and perhaps the period number), but not upon the manner in which that state was reached. The past influences the future only through the present. This is the Markov property.</md:abstract>
  <md:uuid>65de709b-1b8f-4bbd-9f97-e1a74d4817b2</md:uuid>
</metadata>
<featured-links>
  <!-- WARNING! The 'featured-links' section is read only. Do not edit below.
       Changes to the links section in the source will not be saved. -->
    <link-group type="supplemental">
      <link url="http://www.caam.rice.edu/software/PEP_Matlab/Mprobcalc/" strength="3">Catalogue of Useful Matlab Files</link>
      <link url="mfile-suite.zip" strength="3">Download Matlab File Suite</link>
    </link-group>
  <!-- WARNING! The 'featured-links' section is read only. Do not edit above.
       Changes to the links section in the source will not be saved. -->
</featured-links>
<content>
<section id="three">

    <title>Elements of Markov Sequences</title><para id="id338727">Markov sequences (Markov chains) are often studied at a very elementary level, utilizing
algebraic tools such as matrix analysis. In this section, we show that the fundamental
Markov property is an expression of conditional independence of “past” and “future,"
given the “present.” The essential Chapman-Kolmogorov equation is seen as a
consequence of this conditional independence. In the usual time-homogeneous case
with finite state space, the Chapman-Kolmogorov equation leads to the algebraic
formulation that is widely studied at a variety of levels of mathematical sophistication.
With the background laid, we only sketch some of the more common results. This should
provide a probabilistic perspective for a more complete study of the algebraic analysis.</para>


      <para id="fs-id1169781563294"><emphasis effect="bold">Markov sequences</emphasis></para><para id="id338751">We wish to model a system characterized by a sequence of
<emphasis effect="italics">states</emphasis> taken on at discrete instants which we
call <emphasis effect="italics">transition times</emphasis>. At each transition time, there is either
a change to a new state or a renewal of the state immediately before the
transition. Each state is maintained unchanged during the <emphasis effect="italics">period</emphasis> or <emphasis effect="italics">stage</emphasis>
between transitions. At any transition time, the move to the next state is
characterized by a conditional <emphasis effect="italics">transition probability</emphasis> distribution.
We suppose that the system is <emphasis effect="italics">memoryless</emphasis>, in the sense that the transition probabilities
are dependent upon the current state (and perhaps the period number), but
not upon the manner in which that state was reached. <emphasis effect="italics">The past influences the future
only through the present</emphasis>. This is the <emphasis effect="italics">Markov property</emphasis>, which we model in
terms of conditional independence.</para>



      <para id="id338802">For period <emphasis effect="italics">i</emphasis>, the state is represented by a value of a random variable <emphasis effect="italics">X<sub>i</sub></emphasis>, whose
value is one of the members of a set <emphasis effect="bold">E</emphasis>, known as the <emphasis effect="italics">state space</emphasis>. We consider
only a finite state space and identify the states by integers from 1 to <emphasis effect="italics">M</emphasis>.
We thus have a sequence</para>

      <equation id="id338852">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:msub>
              <m:mi>X</m:mi>
              <m:mi mathvariant="bold">N</m:mi>
            </m:msub>
            <m:mo>=</m:mo>
            <m:mrow>
              <m:mo>{</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>n</m:mi>
              </m:msub>
              <m:mo>:</m:mo>
              <m:mi>n</m:mi>
              <m:mo>∈</m:mo>
              <m:mi mathvariant="bold">N</m:mi>
              <m:mo>}</m:mo>
            </m:mrow>
            <m:mo>,</m:mo>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mtext>where</m:mtext>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mi mathvariant="bold">N</m:mi>
            <m:mo>=</m:mo>
            <m:mrow>
              <m:mo>{</m:mo>
              <m:mn>0</m:mn>
              <m:mo>,</m:mo>
              <m:mn>1</m:mn>
              <m:mo>,</m:mo>
              <m:mspace width="0.166667em"/>
              <m:mspace width="0.166667em"/>
              <m:mn>2</m:mn>
              <m:mo>,</m:mo>
              <m:mspace width="0.166667em"/>
              <m:mo>⋯</m:mo>
              <m:mo>}</m:mo>
            </m:mrow>
          </m:mrow>
        </m:math>
      </equation>



      <para id="id338954">We view an observation of the system as a composite trial. Each <emphasis effect="italics">ω</emphasis> yields a
sequence of states <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>X</m:mi><m:mn>0</m:mn></m:msub><m:mrow><m:mo>(</m:mo><m:mi>ω</m:mi><m:mo>)</m:mo></m:mrow><m:mo>,</m:mo><m:msub><m:mi>X</m:mi><m:mn>1</m:mn></m:msub><m:mrow><m:mo>(</m:mo><m:mi>ω</m:mi><m:mo>)</m:mo></m:mrow><m:mo>,</m:mo><m:mo>⋯</m:mo><m:mo>}</m:mo></m:mrow></m:math> which is referred to
as a <emphasis effect="italics">realization</emphasis> of the sequence, or a <emphasis effect="italics">trajectory</emphasis>.  We suppose the
system is evolving in time. At discrete instants of time <m:math overflow="scroll"><m:mrow><m:msub><m:mi>t</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:msub><m:mi>t</m:mi><m:mn>2</m:mn></m:msub><m:mo>,</m:mo><m:mo>⋯</m:mo></m:mrow></m:math> the
system makes a transition from one state to the succeeding one (which may be the same).</para>

      <table id="id339250" summary="Table is structured as a continuous, infinite list of periods, the first column is the respective periods measured, the second and third columns describe properties of these periods.">
<tgroup cols="3"><tbody>
            <row>
              <entry>Initial period:</entry>
              <entry><m:math overflow="scroll"><m:mrow><m:mi>n</m:mi><m:mo>=</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mspace width="0.277778em"/><m:mspace width="0.277778em"/><m:mi>t</m:mi><m:mo>∈</m:mo><m:mo>[</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:msub><m:mi>t</m:mi><m:mn>1</m:mn></m:msub><m:mo>)</m:mo></m:mrow></m:math>,</entry>
              <entry>state is <m:math overflow="scroll"><m:mrow><m:msub><m:mi>X</m:mi><m:mn>0</m:mn></m:msub><m:mrow><m:mo>(</m:mo><m:mi>ω</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math>;  at <emphasis effect="italics">t<sub>1</sub></emphasis> the transition is to <m:math overflow="scroll"><m:mrow><m:msub><m:mi>X</m:mi><m:mn>1</m:mn></m:msub><m:mrow><m:mo>(</m:mo><m:mi>ω</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math></entry>
            </row>
            <row>
              <entry>Period one:</entry>
              <entry><m:math overflow="scroll"><m:mrow><m:mi>n</m:mi><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mspace width="0.277778em"/><m:mspace width="0.277778em"/><m:mi>t</m:mi><m:mo>∈</m:mo><m:mo>[</m:mo><m:msub><m:mi>t</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:msub><m:mi>t</m:mi><m:mn>2</m:mn></m:msub><m:mo>)</m:mo></m:mrow></m:math>,</entry>
              <entry>state is <m:math overflow="scroll"><m:mrow><m:msub><m:mi>X</m:mi><m:mn>1</m:mn></m:msub><m:mrow><m:mo>(</m:mo><m:mi>ω</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math>;  at <emphasis effect="italics">t<sub>2</sub></emphasis> the transition is to <m:math overflow="scroll"><m:mrow><m:msub><m:mi>X</m:mi><m:mn>2</m:mn></m:msub><m:mrow><m:mo>(</m:mo><m:mi>ω</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math></entry>
            </row>
            <row>
              <entry>.....</entry>
              <entry/>
              <entry/>
            </row>
            <row>
              <entry>Period <emphasis effect="italics">k</emphasis>:</entry>
              <entry><m:math overflow="scroll"><m:mrow><m:mi>n</m:mi><m:mo>=</m:mo><m:mi>k</m:mi><m:mo>,</m:mo><m:mspace width="0.277778em"/><m:mspace width="0.277778em"/><m:mi>t</m:mi><m:mo>∈</m:mo><m:mo>[</m:mo><m:msub><m:mi>t</m:mi><m:mi>k</m:mi></m:msub><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:msub><m:mi>t</m:mi><m:mrow><m:mi>k</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>)</m:mo></m:mrow></m:math>,</entry>
              <entry>state is <m:math overflow="scroll"><m:mrow><m:msub><m:mi>X</m:mi><m:mi>k</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>ω</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math>;  at <m:math overflow="scroll"><m:msub><m:mi>t</m:mi><m:mrow><m:mi>k</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub></m:math> move to <m:math overflow="scroll"><m:mrow><m:msub><m:mi>X</m:mi><m:mrow><m:mi>k</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>ω</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math></entry>
            </row>
            <row>
              <entry>.....</entry>
              <entry/>
              <entry/>
            </row>
          </tbody>
        
</tgroup>
</table>
      <!--empty paragraphs get left behind.-->


      <para id="id339671">The parameter <emphasis effect="italics">n</emphasis> indicates the <emphasis effect="italics">period t</emphasis><m:math overflow="scroll"><m:mrow><m:mi/><m:mo>∈</m:mo><m:mo>[</m:mo><m:msub><m:mi>t</m:mi><m:mi>n</m:mi></m:msub><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:msub><m:mi>t</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>)</m:mo></m:mrow></m:math>. If the periods are
of unit length, then <m:math overflow="scroll"><m:mrow><m:msub><m:mi>t</m:mi><m:mi>n</m:mi></m:msub><m:mo>=</m:mo><m:mi>n</m:mi></m:mrow></m:math>. At <m:math overflow="scroll"><m:msub><m:mi>t</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub></m:math>, there is a <emphasis effect="italics">transition</emphasis> from the state
<m:math overflow="scroll"><m:mrow><m:msub><m:mi>X</m:mi><m:mi>n</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>ω</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> to the state <m:math overflow="scroll"><m:mrow><m:msub><m:mi>X</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>ω</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> for the next period.
To simplify writing, we adopt the following convention:</para>


      <equation id="id339821">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:msub>
              <m:mi>U</m:mi>
              <m:mi>n</m:mi>
            </m:msub>
            <m:mo>=</m:mo>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mn>0</m:mn>
              </m:msub>
              <m:mo>,</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mn>1</m:mn>
              </m:msub>
              <m:mo>,</m:mo>
              <m:mo>⋯</m:mo>
              <m:mo>,</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>n</m:mi>
              </m:msub>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>∈</m:mo>
            <m:msub>
              <m:mi mathvariant="bold">E</m:mi>
              <m:mi>n</m:mi>
            </m:msub>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:msub>
              <m:mi>U</m:mi>
              <m:mrow>
                <m:mi>m</m:mi>
                <m:mo>,</m:mo>
                <m:mi>n</m:mi>
              </m:mrow>
            </m:msub>
            <m:mo>=</m:mo>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>m</m:mi>
              </m:msub>
              <m:mo>,</m:mo>
              <m:mo>⋯</m:mo>
              <m:mo>,</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>n</m:mi>
              </m:msub>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mtext>and</m:mtext>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:msup>
              <m:mi>U</m:mi>
              <m:mi>n</m:mi>
            </m:msup>
            <m:mo>=</m:mo>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>n</m:mi>
              </m:msub>
              <m:mo>,</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mrow>
                  <m:mi>n</m:mi>
                  <m:mo>+</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
              </m:msub>
              <m:mo>,</m:mo>
              <m:mo>⋯</m:mo>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>∈</m:mo>
            <m:msup>
              <m:mi mathvariant="bold">E</m:mi>
              <m:mi>n</m:mi>
            </m:msup>
          </m:mrow>
        </m:math>
      </equation>

      <para id="id340008">The random vector <emphasis effect="italics">U<sub>n</sub></emphasis> is called the <emphasis effect="italics">past</emphasis> at <emphasis effect="italics">n</emphasis> of the sequence <emphasis effect="italics">X<sub>N</sub></emphasis> and
<emphasis effect="italics">U<sup>n</sup></emphasis> is the <emphasis effect="italics">future</emphasis> at <emphasis effect="italics">n</emphasis>.
In order to capture the notion that the system is without memory, so that
the future is affected by the present, but not by how the present is reached,
we utilize the notion of conditional independence, given a random vector, in the following</para>


      <para id="id340084"><emphasis effect="bold">Definition</emphasis>.  The sequence <emphasis effect="italics">X<sub>N</sub></emphasis> is <emphasis effect="italics">Markov</emphasis> iff</para>
      <equation id="id340111">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mtext>(M)</m:mtext>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mrow>
              <m:mo>{</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mrow>
                  <m:mi>n</m:mi>
                  <m:mo>+</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
              </m:msub>
              <m:mo>,</m:mo>
              <m:mspace width="0.166667em"/>
              <m:msub>
                <m:mi>U</m:mi>
                <m:mi>n</m:mi>
              </m:msub>
              <m:mo>}</m:mo>
            </m:mrow>
            <m:mrow>
              <m:mspace width="0.166667em"/>
              <m:mi> ci </m:mi>
              <m:mspace width="0.166667em"/>
              <m:mo>|</m:mo>
            </m:mrow>
            <m:msub>
              <m:mi>X</m:mi>
              <m:mi>n</m:mi>
            </m:msub>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mtext>for</m:mtext>
            <m:mspace width="4.pt"/>
            <m:mtext>all</m:mtext>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mi>n</m:mi>
            <m:mo>≥</m:mo>
            <m:mn>0</m:mn>
          </m:mrow>
        </m:math>
      </equation>


      <para id="id340210">Several conditions equivalent to the Markov condition (M) may be obtained with the aid
of properties of conditional independence. We note first that (M) is equivalent to</para>


      <equation id="id340217">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>P</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mrow>
                  <m:mi>n</m:mi>
                  <m:mo>+</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
              </m:msub>
              <m:mo>=</m:mo>
              <m:mi>k</m:mi>
              <m:mo>|</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>n</m:mi>
              </m:msub>
              <m:mo>=</m:mo>
              <m:mi>j</m:mi>
              <m:mo>,</m:mo>
              <m:msub>
                <m:mi>U</m:mi>
                <m:mrow>
                  <m:mi>n</m:mi>
                  <m:mo>-</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
              </m:msub>
              <m:mo>∈</m:mo>
              <m:mi>Q</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mi>P</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mrow>
                  <m:mi>n</m:mi>
                  <m:mo>+</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
              </m:msub>
              <m:mo>=</m:mo>
              <m:mi>k</m:mi>
              <m:mo>|</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>n</m:mi>
              </m:msub>
              <m:mo>=</m:mo>
              <m:mi>j</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
          </m:mrow>
          <m:mrow>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mtext>for</m:mtext>
            <m:mspace width="4.pt"/>
            <m:mtext>each</m:mtext>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mi>n</m:mi>
            <m:mo>≥</m:mo>
            <m:mn>0</m:mn>
            <m:mo>,</m:mo>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mi>j</m:mi>
            <m:mo>,</m:mo>
            <m:mspace width="0.166667em"/>
            <m:mi>k</m:mi>
            <m:mo>∈</m:mo>
            <m:mi mathvariant="bold">E</m:mi>
            <m:mo>,</m:mo>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mtext>and</m:mtext>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mi>Q</m:mi>
            <m:mo>⊂</m:mo>
            <m:msup>
              <m:mi mathvariant="bold">E</m:mi>
              <m:mrow>
                <m:mi>n</m:mi>
                <m:mo>-</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
            </m:msup>
          </m:mrow>
        </m:math>
      </equation>


      <para id="id340418">The state in the next period is conditioned by the past only through the
present state, and not by the manner in which the present state is reached.
The statistics of the process are determined by the <emphasis effect="italics">initial state
probabilities</emphasis> and the <emphasis effect="italics">transition probabilities</emphasis></para>



      <equation id="id340435">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>P</m:mi>
            <m:mo>(</m:mo>
            <m:msub>
              <m:mi>X</m:mi>
              <m:mrow>
                <m:mi>n</m:mi>
                <m:mo>+</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
            </m:msub>
            <m:mo>=</m:mo>
            <m:mi>k</m:mi>
            <m:mo>|</m:mo>
            <m:msub>
              <m:mi>X</m:mi>
              <m:mi>n</m:mi>
            </m:msub>
            <m:mo>=</m:mo>
            <m:mi>j</m:mi>
            <m:mo>)</m:mo>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mo>∀</m:mo>
            <m:mspace width="0.277778em"/>
            <m:mi>j</m:mi>
            <m:mo>,</m:mo>
            <m:mi>k</m:mi>
            <m:mo>∈</m:mo>
            <m:mi mathvariant="bold">E</m:mi>
            <m:mo>,</m:mo>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mi>n</m:mi>
            <m:mo>≥</m:mo>
            <m:mn>0</m:mn>
          </m:mrow>
        </m:math>
      </equation>


      <para id="id340526">The following examples exhibit a pattern which implies
the Markov condition and which can be exploited to obtain the transition
probabilities.</para>


<example id="fs-id1729463">
      <title>  One-dimensional random walk</title>

      <para id="id340541">An object starts at a given initial position. At discrete instants
<m:math overflow="scroll"><m:mrow><m:msub><m:mi>t</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:msub><m:mi>t</m:mi><m:mn>2</m:mn></m:msub><m:mo>,</m:mo><m:mo>⋯</m:mo></m:mrow></m:math> the object moves a random distance along a
line. The various moves are independent of each other. Let</para>

      <list id="fs-id8515294" display="block" list-type="bulleted" bullet-style="none"><item><emphasis effect="italics">Y<sub>0</sub></emphasis> be the initial position</item>

<item><emphasis effect="italics">Y<sub>k</sub></emphasis> be the amount the object moves at time <m:math overflow="scroll"><m:mrow><m:mi>t</m:mi><m:mo>=</m:mo><m:msub><m:mi>t</m:mi><m:mi>k</m:mi></m:msub><m:mspace width="0.277778em"/><m:mspace width="0.277778em"/><m:mspace width="0.277778em"/><m:mrow><m:mo>{</m:mo><m:msub><m:mi>Y</m:mi><m:mi>k</m:mi></m:msub><m:mo>:</m:mo><m:mspace width="0.277778em"/><m:mn>1</m:mn><m:mo>≤</m:mo><m:mi>k</m:mi><m:mo>}</m:mo></m:mrow></m:mrow></m:math> iid</item>

<item><m:math overflow="scroll"><m:mstyle scriptlevel="0" displaystyle="true"><m:mrow><m:msub><m:mi>X</m:mi><m:mi>n</m:mi></m:msub><m:mo>=</m:mo><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>k</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mi>n</m:mi></m:munderover><m:msub><m:mi>Y</m:mi><m:mi>k</m:mi></m:msub></m:mrow></m:mstyle></m:math> be the position after <emphasis effect="italics">n</emphasis> moves.</item></list>
      

<para id="id340730">We note that <m:math overflow="scroll"><m:mrow><m:msub><m:mi>X</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>=</m:mo><m:mi>g</m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>X</m:mi><m:mi>n</m:mi></m:msub><m:mo>,</m:mo><m:msub><m:mi>Y</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>)</m:mo></m:mrow></m:mrow></m:math>. Since the position
after the transition at <m:math overflow="scroll"><m:msub><m:mi>t</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub></m:math> is affected by the past only by the
value of the position <emphasis effect="italics">X<sub>n</sub></emphasis> and not by the sequence of positions which
led to this position, it is reasonable to suppose that the process
<emphasis effect="italics">X<sub>N</sub></emphasis> is Markov. We verify this below.</para>

      </example>


<example id="fs-id7918142">
<title>  A class of branching processes</title>
      <para id="id340858">Each member of a population is able to reproduce. For simplicity, we
suppose that at certain discrete instants the entire next generation
is produced. Some mechanism limits each generation to a maximum
population of <emphasis effect="italics">M</emphasis> members. Let</para>

      <list id="fs-id8732811" display="block" list-type="bulleted" bullet-style="none"><item><m:math overflow="scroll"><m:msub><m:mi>Z</m:mi><m:mrow><m:mi>i</m:mi><m:mi>n</m:mi></m:mrow></m:msub></m:math> be the number propagated by the <emphasis effect="italics">i</emphasis>th member of the <emphasis effect="italics">n</emphasis>th generation.
      </item>

      <item><m:math overflow="scroll"><m:mrow><m:msub><m:mi>Z</m:mi><m:mrow><m:mi>i</m:mi><m:mi>n</m:mi></m:mrow></m:msub><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:math> indicates death and no offspring, <m:math overflow="scroll"><m:mrow><m:msub><m:mi>Z</m:mi><m:mrow><m:mi>i</m:mi><m:mi>n</m:mi></m:mrow></m:msub><m:mo>=</m:mo><m:mi>k</m:mi></m:mrow></m:math>
indicates a net of <emphasis effect="italics">k</emphasis> propagated by the <emphasis effect="italics">i</emphasis>th member (either death and
<emphasis effect="italics">k</emphasis> offspring or survival and <m:math overflow="scroll"><m:mrow><m:mi>k</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:math> offspring).
      </item>
</list>

      <para id="id341005">The population in generation <m:math overflow="scroll"><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:math> is given by</para>

      <equation id="id341023"><m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:msub>
              <m:mi>X</m:mi>
              <m:mrow>
                <m:mi>n</m:mi>
                <m:mo>+</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
            </m:msub>
            <m:mo>=</m:mo>
            <m:mo movablelimits="true" form="prefix">min</m:mo>
            <m:mspace width="0.166667em"/>
            <m:mfenced separators="" open="{" close="}">
              <m:mi>M</m:mi>
              <m:mo>,</m:mo>
              <m:mspace width="0.277778em"/>
              <m:munderover>
                <m:mrow><m:mo>∑</m:mo></m:mrow>
                <m:mrow>
                  <m:mi>i</m:mi>
                  <m:mo>=</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
                <m:msub>
                  <m:mi>X</m:mi>
                  <m:mi>n</m:mi>
                </m:msub>
              </m:munderover>
              <m:msub>
                <m:mi>Z</m:mi>
                <m:mrow>
                  <m:mi>i</m:mi>
                  <m:mi>n</m:mi>
                </m:mrow>
              </m:msub>
            </m:mfenced>
          </m:mrow>
        </m:math>
      </equation>


      <para id="id341105">We suppose the class <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>Z</m:mi><m:mrow><m:mi>i</m:mi><m:mi>n</m:mi></m:mrow></m:msub><m:mo>:</m:mo><m:mspace width="0.277778em"/><m:mn>1</m:mn><m:mo>≤</m:mo><m:mi>i</m:mi><m:mo>≤</m:mo><m:mi>M</m:mi><m:mo>,</m:mo><m:mspace width="0.277778em"/><m:mn>0</m:mn><m:mo>≤</m:mo><m:mi>n</m:mi><m:mo>}</m:mo></m:mrow></m:math> is iid. Let
<m:math overflow="scroll"><m:mrow><m:msub><m:mi>Y</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>=</m:mo><m:mrow><m:mo>(</m:mo><m:msub><m:mi>Z</m:mi><m:mrow><m:mn>1</m:mn><m:mi>n</m:mi></m:mrow></m:msub><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:msub><m:mi>Z</m:mi><m:mrow><m:mn>2</m:mn><m:mi>n</m:mi></m:mrow></m:msub><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mo>⋯</m:mo><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:msub><m:mi>Z</m:mi><m:mrow><m:mi>M</m:mi><m:mi>n</m:mi></m:mrow></m:msub><m:mo>)</m:mo></m:mrow></m:mrow></m:math>. Then <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>Y</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:msub><m:mi>U</m:mi><m:mi>n</m:mi></m:msub><m:mo>}</m:mo></m:mrow></m:math>
is independent. It seems reasonable to suppose the sequence <emphasis effect="italics">X<sub>N</sub></emphasis> is Markov.</para>
      </example>


<example id="fs-id1171020808877">
      <title>  An inventory problem</title>
      <para id="id341319">A certain item is stocked according to an <m:math overflow="scroll"><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>,</m:mo><m:mi>M</m:mi><m:mo>)</m:mo></m:mrow></m:math> inventory policy, as
follows:</para>

      <list id="fs-id5924369" display="block">
        <item id="uid1">If stock at the end of a period is less than <emphasis effect="italics">m</emphasis>, order up to <emphasis effect="italics">M</emphasis>.
</item>

        <item id="uid2">If stock at the end of a period is <emphasis effect="italics">m</emphasis> or greater, do not order.
</item>

      </list>

      <para id="id341401">Let <emphasis effect="italics">X<sub>0</sub></emphasis> be the initial stock, and <emphasis effect="italics">X<sub>n</sub></emphasis> be the stock at
the end of the <emphasis effect="italics">n</emphasis>th period (before restocking), and let
<emphasis effect="italics">D<sub>n</sub></emphasis> be the demand during the <emphasis effect="italics">n</emphasis>th period. Then for <m:math overflow="scroll"><m:mrow><m:mi>n</m:mi><m:mo>≥</m:mo><m:mn>0</m:mn></m:mrow></m:math>,</para>

      <equation id="id341479">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:msub>
              <m:mi>X</m:mi>
              <m:mrow>
                <m:mi>n</m:mi>
                <m:mo>+</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
            </m:msub>
            <m:mo>=</m:mo>
            <m:mfenced separators="" open="{" close="">
              <m:mtable>
                <m:mtr>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mo movablelimits="true" form="prefix">max</m:mo>
                      <m:mo>{</m:mo>
                      <m:mi>M</m:mi>
                      <m:mo>-</m:mo>
                      <m:msub>
                        <m:mi>D</m:mi>
                        <m:mrow>
                          <m:mi>n</m:mi>
                          <m:mo>+</m:mo>
                          <m:mn>1</m:mn>
                        </m:mrow>
                      </m:msub>
                      <m:mo>,</m:mo>
                      <m:mspace width="0.277778em"/>
                      <m:mn>0</m:mn>
                      <m:mo>}</m:mo>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mspace width="0.277778em"/>
                      <m:mtext>if</m:mtext>
                      <m:mspace width="0.277778em"/>
                      <m:mspace width="0.277778em"/>
                      <m:mn>0</m:mn>
                      <m:mo>≤</m:mo>
                      <m:msub>
                        <m:mi>X</m:mi>
                        <m:mi>n</m:mi>
                      </m:msub>
                      <m:mo>&lt;</m:mo>
                      <m:mi>m</m:mi>
                    </m:mrow>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mo movablelimits="true" form="prefix">max</m:mo>
                      <m:mo>{</m:mo>
                      <m:msub>
                        <m:mi>X</m:mi>
                        <m:mi>n</m:mi>
                      </m:msub>
                      <m:mo>-</m:mo>
                      <m:msub>
                        <m:mi>D</m:mi>
                        <m:mrow>
                          <m:mi>n</m:mi>
                          <m:mo>+</m:mo>
                          <m:mn>1</m:mn>
                        </m:mrow>
                      </m:msub>
                      <m:mo>,</m:mo>
                      <m:mspace width="0.277778em"/>
                      <m:mn>0</m:mn>
                      <m:mo>}</m:mo>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mspace width="0.277778em"/>
                      <m:mtext>if</m:mtext>
                      <m:mspace width="0.277778em"/>
                      <m:mspace width="0.277778em"/>
                      <m:mi>m</m:mi>
                      <m:mo>≤</m:mo>
                      <m:msub>
                        <m:mi>X</m:mi>
                        <m:mi>n</m:mi>
                      </m:msub>
                    </m:mrow>
                  </m:mtd>
                </m:mtr>
              </m:mtable>
            </m:mfenced>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mo>=</m:mo>
            <m:mi>g</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>n</m:mi>
              </m:msub>
              <m:mo>,</m:mo>
              <m:msub>
                <m:mi>D</m:mi>
                <m:mrow>
                  <m:mi>n</m:mi>
                  <m:mo>+</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
              </m:msub>
              <m:mo>)</m:mo>
            </m:mrow>
          </m:mrow>
        </m:math>
      </equation>


      <para id="id341700">If we suppose <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>D</m:mi><m:mi>n</m:mi></m:msub><m:mo>:</m:mo><m:mn>1</m:mn><m:mo>≤</m:mo><m:mi>n</m:mi><m:mo>}</m:mo></m:mrow></m:math> is independent, then
<m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>D</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:msub><m:mi>U</m:mi><m:mi>n</m:mi></m:msub><m:mo>}</m:mo></m:mrow></m:math> is independent for each <m:math overflow="scroll"><m:mrow><m:mi>n</m:mi><m:mo>≥</m:mo><m:mn>0</m:mn></m:mrow></m:math>, and the
Markov condition seems to be indicated.</para>
      </example>


      <para id="id341803"><emphasis effect="italics">Remark</emphasis>. In this case, the actual transition takes place throughout
the period. However, for purposes of analysis, we examine the state only
at the end of the period (before restocking). Thus, the transitions are
dispersed in time, but the observations are at discrete instants.</para>



<example id="fs-id1171025385356">
      <title>  Remaining lifetime</title>
      <para id="id341820">A piece of equipment has a lifetime which is an integral number of units of
time. When a unit fails, it is replaced immediately with another unit of
the same type. Suppose</para>
      <list id="fs-id8220108" list-type="bulleted" bullet-style="bullet"><item><emphasis effect="italics">X<sub>n</sub></emphasis> is the remaining lifetime of the unit in service at time <emphasis effect="italics">n</emphasis></item>
      
<item><m:math overflow="scroll"><m:msub><m:mi>Y</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub></m:math> is the lifetime of the unit installed at time <emphasis effect="italics">n</emphasis>, with <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>Y</m:mi><m:mi>n</m:mi></m:msub><m:mo>:</m:mo><m:mn>1</m:mn><m:mo>≤</m:mo><m:mi>n</m:mi><m:mo>}</m:mo></m:mrow></m:math> iid</item>

</list>

      <equation id="id341920">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mtext>Then</m:mtext>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:msub>
              <m:mi>X</m:mi>
              <m:mrow>
                <m:mi>n</m:mi>
                <m:mo>+</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
            </m:msub>
            <m:mo>=</m:mo>
            <m:mfenced separators="" open="{" close="">
              <m:mtable>
                <m:mtr>
                  <m:mtd>
                    <m:mrow>
                      <m:msub>
                        <m:mi>X</m:mi>
                        <m:mi>n</m:mi>
                      </m:msub>
                      <m:mo>-</m:mo>
                      <m:mn>1</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mspace width="0.277778em"/>
                      <m:mtext>if</m:mtext>
                      <m:mspace width="0.277778em"/>
                      <m:mspace width="0.277778em"/>
                      <m:msub>
                        <m:mi>X</m:mi>
                        <m:mi>n</m:mi>
                      </m:msub>
                      <m:mo>≥</m:mo>
                      <m:mn>1</m:mn>
                    </m:mrow>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd>
                    <m:mrow>
                      <m:msub>
                        <m:mi>Y</m:mi>
                        <m:mrow>
                          <m:mi>n</m:mi>
                          <m:mo>+</m:mo>
                          <m:mn>1</m:mn>
                        </m:mrow>
                      </m:msub>
                      <m:mo>-</m:mo>
                      <m:mn>1</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mspace width="0.277778em"/>
                      <m:mtext>if</m:mtext>
                      <m:mspace width="0.277778em"/>
                      <m:mspace width="0.277778em"/>
                      <m:msub>
                        <m:mi>X</m:mi>
                        <m:mi>n</m:mi>
                      </m:msub>
                      <m:mo>=</m:mo>
                      <m:mn>0</m:mn>
                    </m:mrow>
                  </m:mtd>
                </m:mtr>
              </m:mtable>
            </m:mfenced>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mo>=</m:mo>
            <m:mi>g</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>n</m:mi>
              </m:msub>
              <m:mo>,</m:mo>
              <m:mspace width="0.166667em"/>
              <m:msub>
                <m:mi>Y</m:mi>
                <m:mrow>
                  <m:mi>n</m:mi>
                  <m:mo>+</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
              </m:msub>
              <m:mo>)</m:mo>
            </m:mrow>
          </m:mrow>
        </m:math>
      </equation>
      </example>


      <para id="id342114"><emphasis effect="italics">Remark</emphasis>. Each of these four examples exhibits the pattern</para>

      <list id="eip-id11562835" list-type="enumerated" number-style="lower-roman"><item><m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>X</m:mi><m:mn>0</m:mn></m:msub><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:msub><m:mi>Y</m:mi><m:mi>n</m:mi></m:msub><m:mo>:</m:mo><m:mn>1</m:mn><m:mo>≤</m:mo><m:mi>n</m:mi><m:mo>}</m:mo></m:mrow></m:math> is independent</item>     

<item> <m:math overflow="scroll"><m:mrow><m:msub><m:mi>X</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>=</m:mo><m:msub><m:mi>g</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:msub><m:mi>X</m:mi><m:mi>n</m:mi></m:msub><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:msub><m:mi>Y</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>)</m:mo></m:mrow><m:mo>,</m:mo><m:mspace width="0.277778em"/><m:mspace width="0.277778em"/><m:mspace width="0.277778em"/><m:mi>n</m:mi><m:mo>≥</m:mo><m:mn>0</m:mn></m:mrow></m:math></item></list>

      <para id="id342256">We now verify the Markov condition and obtain a method for determining the
transition probabilities.</para>
    
    
    <para id="fs-id6801192"><emphasis effect="bold"> A pattern yielding Markov sequences</emphasis></para>

      <para id="id342270">Suppose <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>Y</m:mi><m:mi>n</m:mi></m:msub><m:mo>:</m:mo><m:mn>0</m:mn><m:mo>≤</m:mo><m:mi>n</m:mi><m:mo>}</m:mo></m:mrow></m:math> is independent (call these the <emphasis effect="italics">driving random variables</emphasis>). Set</para>

      <equation id="id342311">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:msub>
              <m:mi>X</m:mi>
              <m:mn>0</m:mn>
            </m:msub>
            <m:mo>=</m:mo>
            <m:msub>
              <m:mi>g</m:mi>
              <m:mn>0</m:mn>
            </m:msub>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msub>
                <m:mi>Y</m:mi>
                <m:mn>0</m:mn>
              </m:msub>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mtext>and</m:mtext>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:msub>
              <m:mi>X</m:mi>
              <m:mrow>
                <m:mi>n</m:mi>
                <m:mo>+</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
            </m:msub>
            <m:mo>=</m:mo>
            <m:msub>
              <m:mi>g</m:mi>
              <m:mrow>
                <m:mi>n</m:mi>
                <m:mo>+</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
            </m:msub>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>n</m:mi>
              </m:msub>
              <m:mo>,</m:mo>
              <m:mspace width="0.166667em"/>
              <m:msub>
                <m:mi>Y</m:mi>
                <m:mrow>
                  <m:mi>n</m:mi>
                  <m:mo>+</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
              </m:msub>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mo>∀</m:mo>
            <m:mspace width="0.277778em"/>
            <m:mi>n</m:mi>
            <m:mo>≥</m:mo>
            <m:mn>0</m:mn>
          </m:mrow>
        </m:math>
      </equation>

      <para id="id342454">Then</para>

      <list id="id342460" list-type="enumerated" number-style="lower-alpha">

        <item id="uid3"><emphasis effect="italics">X<sub>N</sub></emphasis> is Markov
</item>

        <item id="uid4"><m:math overflow="scroll"><m:mrow><m:mi>P</m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>X</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>∈</m:mo><m:mi>Q</m:mi><m:mo>|</m:mo><m:msub><m:mi>X</m:mi><m:mi>n</m:mi></m:msub><m:mo>=</m:mo><m:mi>u</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mi>P</m:mi><m:mrow><m:mo>[</m:mo><m:msub><m:mi>g</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>u</m:mi><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:msub><m:mi>Y</m:mi><m:mi>n</m:mi></m:msub><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow><m:mo>∈</m:mo><m:mi>Q</m:mi><m:mo>]</m:mo></m:mrow></m:mrow></m:math> for all <m:math overflow="scroll"><m:mrow><m:mi>n</m:mi><m:mo>,</m:mo><m:mspace width="0.277778em"/><m:mi>u</m:mi></m:mrow></m:math>,
and any Borel set <emphasis effect="italics">Q</emphasis>.
</item>
      </list>

      <para id="id342633">VERIFICATION</para>

      <list id="id342636" list-type="enumerated" number-style="lower-alpha"><item id="uid5">It is apparent that if 
<m:math overflow="scroll"><m:mrow><m:msub><m:mi>Y</m:mi><m:mn>0</m:mn></m:msub><m:mo>,</m:mo><m:msub><m:mi>Y</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:mo>⋯</m:mo><m:mo>,</m:mo><m:msub><m:mi>Y</m:mi><m:mi>n</m:mi></m:msub></m:mrow></m:math> 
are known, then

<emphasis effect="italics">U<sub>n</sub></emphasis> 
is known. Thus

<m:math overflow="scroll"><m:mrow><m:msub><m:mi>U</m:mi><m:mi>n</m:mi></m:msub><m:mo>=</m:mo><m:msub><m:mi>h</m:mi><m:mi>n</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:msub><m:mi>Y</m:mi><m:mn>0</m:mn></m:msub><m:mo>,</m:mo><m:msub><m:mi>Y</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:mo>⋯</m:mo><m:mo>,</m:mo><m:msub><m:mi>Y</m:mi><m:mi>n</m:mi></m:msub><m:mo>)</m:mo></m:mrow></m:mrow></m:math>
, which
ensures each pair <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>Y</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>,</m:mo><m:msub><m:mi>U</m:mi><m:mi>n</m:mi></m:msub><m:mo>}</m:mo></m:mrow></m:math> is independent.

By property <link document="m24003" target-id="uid13">(CI13)</link>, with <m:math overflow="scroll"><m:mrow><m:mi>X</m:mi><m:mo>=</m:mo><m:msub><m:mi>Y</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>,</m:mo><m:mi>Y</m:mi><m:mo>=</m:mo><m:msub><m:mi>X</m:mi><m:mi>n</m:mi></m:msub></m:mrow></m:math>, and <m:math overflow="scroll"><m:mrow><m:mi>Z</m:mi><m:mo>=</m:mo><m:msub><m:mi>U</m:mi><m:mrow><m:mi>n</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub></m:mrow></m:math>, we have

<equation id="id342898"><m:math overflow="scroll" mode="display"><m:mrow><m:mrow><m:mo>{</m:mo><m:msub><m:mi>Y</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>,</m:mo><m:msub><m:mi>U</m:mi><m:mrow><m:mi>n</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>}</m:mo></m:mrow><m:mrow><m:mi> ci </m:mi><m:mo>|</m:mo></m:mrow><m:msub><m:mi>X</m:mi><m:mi>n</m:mi></m:msub></m:mrow></m:math></equation>

Since <m:math overflow="scroll"><m:mrow><m:msub><m:mi>X</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>=</m:mo><m:msub><m:mi>g</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:msub><m:mi>Y</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>,</m:mo><m:msub><m:mi>X</m:mi><m:mi>n</m:mi></m:msub><m:mo>)</m:mo></m:mrow></m:mrow></m:math> and <m:math overflow="scroll"><m:mrow><m:msub><m:mi>U</m:mi><m:mi>n</m:mi></m:msub><m:mo>=</m:mo><m:msub><m:mi>h</m:mi><m:mi>n</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:msub><m:mi>X</m:mi><m:mi>n</m:mi></m:msub><m:mo>,</m:mo><m:msub><m:mi>U</m:mi><m:mrow><m:mi>n</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>)</m:mo></m:mrow></m:mrow></m:math>,

property <link document="m24003" target-id="uid9">(CI9)</link> ensures

<equation id="id343086"><m:math overflow="scroll" mode="display"><m:mrow><m:mrow><m:mo>{</m:mo><m:msub><m:mi>X</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>,</m:mo><m:msub><m:mi>U</m:mi><m:mi>n</m:mi></m:msub><m:mo>}</m:mo></m:mrow><m:mrow><m:mi> ci </m:mi><m:mo>|</m:mo></m:mrow><m:msub><m:mi>X</m:mi><m:mi>n</m:mi></m:msub><m:mo>∀</m:mo><m:mi>n</m:mi><m:mo>≥</m:mo><m:mn>0</m:mn></m:mrow></m:math></equation>
which is the Markov property.
</item>

        <item id="uid6"><m:math overflow="scroll"><m:mrow><m:mi>P</m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>X</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>∈</m:mo><m:mi>Q</m:mi><m:mo>|</m:mo><m:msub><m:mi>X</m:mi><m:mi>n</m:mi></m:msub><m:mo>=</m:mo><m:mi>u</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mi>E</m:mi><m:mrow><m:mo>{</m:mo><m:msub><m:mi>I</m:mi><m:mi>Q</m:mi></m:msub><m:mrow><m:mo>[</m:mo><m:msub><m:mi>g</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:msub><m:mi>X</m:mi><m:mi>n</m:mi></m:msub><m:mo>,</m:mo><m:msub><m:mi>Y</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>)</m:mo></m:mrow><m:mo>]</m:mo></m:mrow><m:mo>|</m:mo><m:msub><m:mi>X</m:mi><m:mi>n</m:mi></m:msub><m:mo>=</m:mo><m:mi>u</m:mi><m:mo>}</m:mo></m:mrow><m:mspace width="4pt"/><m:mi mathvariant="normal">a</m:mi><m:mo>.</m:mo><m:mi mathvariant="normal">s</m:mi><m:mo>.</m:mo></m:mrow></m:math>
                          <m:math overflow="scroll"><m:mrow><m:mo>=</m:mo><m:mi>E</m:mi><m:mrow><m:mo>{</m:mo><m:msub><m:mi>I</m:mi><m:mi>Q</m:mi></m:msub><m:mrow><m:mo>[</m:mo><m:msub><m:mi>g</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>u</m:mi><m:mo>,</m:mo><m:msub><m:mi>Y</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>)</m:mo></m:mrow><m:mo>]</m:mo></m:mrow><m:mo>}</m:mo></m:mrow><m:mi mathvariant="normal">a</m:mi><m:mo>.</m:mo><m:mi mathvariant="normal">s</m:mi><m:mo>.</m:mo><m:mspace width="0.166667em"/><m:mrow><m:mo>[</m:mo><m:msub><m:mi>P</m:mi><m:mi>X</m:mi></m:msub><m:mo>]</m:mo></m:mrow></m:mrow></m:math> by <link document="m24001" target-id="uid10">(CE10b)</link>
                          <m:math overflow="scroll"><m:mrow><m:mo>=</m:mo><m:mi>P</m:mi><m:mo>[</m:mo><m:msub><m:mi>g</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>u</m:mi><m:mo>,</m:mo><m:msub><m:mi>Y</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>)</m:mo></m:mrow><m:mo>∈</m:mo><m:mi>Q</m:mi><m:mo>]</m:mo></m:mrow></m:math> by <link document="m23998" target-id="uid2">(E1a)</link>
</item>
      </list>

      <para id="id343512">— <m:math overflow="scroll"><m:mo>□</m:mo></m:math></para>

      <para id="id343525">The application of this proposition, below, to the previous examples shows that
the transition probabilities are invariant with <emphasis effect="italics">n</emphasis>. This case is
important enough to warrant separate classification.</para>

      <para id="id343539"><emphasis effect="bold">Definition</emphasis>. If <m:math overflow="scroll"><m:mrow><m:mi>P</m:mi><m:mo>(</m:mo><m:msub><m:mi>X</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>∈</m:mo><m:mi>Q</m:mi><m:mo>|</m:mo><m:msub><m:mi>X</m:mi><m:mi>n</m:mi></m:msub><m:mo>=</m:mo><m:mi>u</m:mi><m:mo>)</m:mo></m:mrow></m:math> is invariant
with <emphasis effect="italics">n</emphasis>, for all Borel sets <emphasis effect="italics">Q</emphasis>, all <m:math overflow="scroll"><m:mrow><m:mi>u</m:mi><m:mo>∈</m:mo><m:mi mathvariant="bold">E</m:mi></m:mrow></m:math>, the Markov process
<emphasis effect="italics">X<sub>N</sub></emphasis> is said to be <emphasis effect="italics">homogeneous</emphasis>.</para>

      <para id="id343647">As a matter of fact, this is the only case usually treated in elementary
texts. In this regard, we note the following special case of the proposition above.</para>

      <para id="id343652">
        <emphasis effect="italics">Homogenous Markov sequences</emphasis>
      </para>

      <para id="id343659">If <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>Y</m:mi><m:mi>n</m:mi></m:msub><m:mo>:</m:mo><m:mn>1</m:mn><m:mo>≤</m:mo><m:mi>n</m:mi><m:mo>}</m:mo></m:mrow></m:math> is iid and <m:math overflow="scroll"><m:mrow><m:msub><m:mi>g</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>=</m:mo><m:mi>g</m:mi></m:mrow></m:math> for all <emphasis effect="italics">n</emphasis>, then the process
is a homogeneous Markov process, and</para>

      <equation id="id343729">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>P</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mrow>
                  <m:mi>n</m:mi>
                  <m:mo>+</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
              </m:msub>
              <m:mo>∈</m:mo>
              <m:mi>Q</m:mi>
              <m:mo>|</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>n</m:mi>
              </m:msub>
              <m:mo>=</m:mo>
              <m:mi>u</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mi>P</m:mi>
            <m:mrow>
              <m:mo>[</m:mo>
              <m:mi>g</m:mi>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>u</m:mi>
                <m:mo>,</m:mo>
                <m:mspace width="0.166667em"/>
                <m:msub>
                  <m:mi>Y</m:mi>
                  <m:mrow>
                    <m:mi>n</m:mi>
                    <m:mo>+</m:mo>
                    <m:mn>1</m:mn>
                  </m:mrow>
                </m:msub>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mo>∈</m:mo>
              <m:mi>Q</m:mi>
              <m:mo>]</m:mo>
            </m:mrow>
            <m:mo>,</m:mo>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mtext>invariant</m:mtext>
            <m:mspace width="4.pt"/>
            <m:mtext>with</m:mtext>
            <m:mspace width="0.277778em"/>
            <m:mi>n</m:mi>
          </m:mrow>
        </m:math>
      </equation>

      <para id="id343844">— <m:math overflow="scroll"><m:mo>□</m:mo></m:math></para>

      <para id="id343859"><emphasis effect="italics">Remark</emphasis>.</para>

      <para id="id343866">In the homogeneous case, the transition probabilities are invariant with <emphasis effect="italics">n</emphasis>.
In this case, we write</para>

      <equation id="id343880">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>P</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mrow>
                  <m:mi>n</m:mi>
                  <m:mo>+</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
              </m:msub>
              <m:mo>=</m:mo>
              <m:mi>j</m:mi>
              <m:mo>|</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>n</m:mi>
              </m:msub>
              <m:mo>=</m:mo>
              <m:mi>i</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mi>p</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>i</m:mi>
              <m:mo>,</m:mo>
              <m:mi>j</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mtext>or</m:mtext>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:msub>
              <m:mi>p</m:mi>
              <m:mrow>
                <m:mi>i</m:mi>
                <m:mi>j</m:mi>
              </m:mrow>
            </m:msub>
            <m:mrow>
              <m:mspace width="0.277778em"/>
              <m:mspace width="0.277778em"/>
              <m:mspace width="0.277778em"/>
              <m:mspace width="0.277778em"/>
              <m:mtext>(invariant</m:mtext>
              <m:mspace width="4.pt"/>
              <m:mtext>with</m:mtext>
              <m:mspace width="0.277778em"/>
              <m:mi>n</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
          </m:mrow>
        </m:math>
      </equation>

      <para id="id343999">These are called the <emphasis effect="italics">(one-step) transition probabilities</emphasis>.</para>

      <para id="id344011">The transition probabilities may be arranged in a matrix <emphasis effect="bold">P</emphasis> called the <emphasis effect="italics">transition
probability matrix</emphasis>, usually referred to as the <emphasis effect="italics">transition matrix</emphasis>,</para>


      <equation id="id344037">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi mathvariant="bold">P</m:mi>
            <m:mo>=</m:mo>
            <m:mo>[</m:mo>
            <m:mi>p</m:mi>
            <m:mo>(</m:mo>
            <m:mi>i</m:mi>
            <m:mo>,</m:mo>
            <m:mspace width="0.166667em"/>
            <m:mi>j</m:mi>
            <m:mo>)</m:mo>
            <m:mo>]</m:mo>
          </m:mrow>
        </m:math>
      </equation>

      <para id="id344074">The element <m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>,</m:mo><m:mi>j</m:mi><m:mo>)</m:mo></m:mrow></m:math> on row <emphasis effect="italics">i</emphasis> and column <emphasis effect="italics">j</emphasis> is the probability <m:math overflow="scroll"><m:mrow><m:mi>P</m:mi><m:mo>(</m:mo><m:msub><m:mi>X</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>=</m:mo><m:mi>j</m:mi><m:mo>|</m:mo><m:msub><m:mi>X</m:mi><m:mi>n</m:mi></m:msub><m:mo>=</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:math>.
Thus, the elements on the <emphasis effect="italics">i</emphasis>th row constitute the conditional distribution for
<m:math overflow="scroll"><m:msub><m:mi>X</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub></m:math>, given <m:math overflow="scroll"><m:mrow><m:msub><m:mi>X</m:mi><m:mi>n</m:mi></m:msub><m:mo>=</m:mo><m:mi>i</m:mi></m:mrow></m:math>. The transition matrix thus has the property that
<emphasis effect="italics">each row sums to one</emphasis>.  Such a matrix is called a <emphasis effect="italics">stochastic matrix</emphasis>.
We return to the examples. From the propositions on transition probabilities, it is
apparent that each is Markov. Since the function <emphasis effect="italics">g</emphasis> is the same for all
<emphasis effect="italics">n</emphasis> and the driving random variables corresponding to the <emphasis effect="italics">Y<sub>i</sub></emphasis> form an iid
class, the sequences must be homogeneous. We may utilize part (b) of the propositions
to obtain the one-step transition probabilities.</para>


<example id="fs-id1171029910623">
      <title>  Random walk continued</title>

      <para id="id344265"><m:math overflow="scroll"><m:mrow><m:msub><m:mi>g</m:mi><m:mi>n</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>u</m:mi><m:mo>,</m:mo><m:msub><m:mi>Y</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mi>u</m:mi><m:mo>+</m:mo><m:msub><m:mi>Y</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub></m:mrow></m:math>, so that <emphasis effect="italics">g<sub>n</sub></emphasis> is
invariant with <emphasis effect="italics">n</emphasis>. Since <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>Y</m:mi><m:mi>n</m:mi></m:msub><m:mo>:</m:mo><m:mn>1</m:mn><m:mo>≤</m:mo><m:mi>n</m:mi><m:mo>}</m:mo></m:mrow></m:math> is iid,</para>

      <equation id="id344382">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>P</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mrow>
                  <m:mi>n</m:mi>
                  <m:mo>+</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
              </m:msub>
              <m:mo>=</m:mo>
              <m:mi>k</m:mi>
              <m:mo>|</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>n</m:mi>
              </m:msub>
              <m:mo>=</m:mo>
              <m:mi>j</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mi>P</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>j</m:mi>
              <m:mo>+</m:mo>
              <m:mi>Y</m:mi>
              <m:mo>=</m:mo>
              <m:mi>k</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mi>P</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>Y</m:mi>
              <m:mo>=</m:mo>
              <m:mi>k</m:mi>
              <m:mo>-</m:mo>
              <m:mi>j</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:msub>
              <m:mi>p</m:mi>
              <m:mrow>
                <m:mi>k</m:mi>
                <m:mo>-</m:mo>
                <m:mi>j</m:mi>
              </m:mrow>
            </m:msub>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mtext>where</m:mtext>
            <m:mspace width="0.277778em"/>
            <m:msub>
              <m:mi>p</m:mi>
              <m:mi>k</m:mi>
            </m:msub>
            <m:mo>=</m:mo>
            <m:mi>P</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>Y</m:mi>
              <m:mo>=</m:mo>
              <m:mi>k</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
          </m:mrow>
        </m:math>
      </equation>
      </example>

<example id="fs-id8065085">
      <title>  Branching process continued</title>
      <para id="id344548"><m:math overflow="scroll"><m:mstyle scriptlevel="0" displaystyle="true"><m:mrow><m:mi>g</m:mi><m:mrow><m:mo>(</m:mo><m:mi>j</m:mi><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:msub><m:mi>Y</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mo movablelimits="true" form="prefix">min</m:mo><m:mrow><m:mo>{</m:mo><m:mi>M</m:mi><m:mo>,</m:mo><m:mspace width="0.277778em"/><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow><m:mi>j</m:mi></m:munderover><m:msub><m:mi>Z</m:mi><m:mrow><m:mi>i</m:mi><m:mi>n</m:mi></m:mrow></m:msub><m:mo>}</m:mo></m:mrow></m:mrow></m:mstyle></m:math> and <m:math overflow="scroll"><m:mrow><m:mi mathvariant="bold">E</m:mi><m:mo>=</m:mo><m:mo>{</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mn>1</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mo>⋯</m:mo><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>M</m:mi><m:mo>}</m:mo></m:mrow></m:math>. If <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>Z</m:mi><m:mrow><m:mi>i</m:mi><m:mi>n</m:mi></m:mrow></m:msub><m:mo>:</m:mo><m:mspace width="0.277778em"/><m:mn>1</m:mn><m:mo>≤</m:mo><m:mi>i</m:mi><m:mo>≤</m:mo><m:mi>M</m:mi><m:mo>,</m:mo><m:mspace width="0.277778em"/><m:mn>1</m:mn><m:mo>≤</m:mo><m:mi>n</m:mi><m:mo>}</m:mo></m:mrow></m:math> is iid,
then</para>

      <equation id="id344738"><m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:msub>
              <m:mi>W</m:mi>
              <m:mrow>
                <m:mi>j</m:mi>
                <m:mi>n</m:mi>
              </m:mrow>
            </m:msub>
            <m:mo>=</m:mo>
            <m:munderover>
              <m:mrow><m:mo>∑</m:mo></m:mrow>
              <m:mrow>
                <m:mi>i</m:mi>
                <m:mo>=</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
              <m:mi>j</m:mi>
            </m:munderover>
            <m:msub>
              <m:mi>Z</m:mi>
              <m:mrow>
                <m:mi>i</m:mi>
                <m:mi>n</m:mi>
              </m:mrow>
            </m:msub>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mtext>ensures</m:mtext>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mrow>
              <m:mo>{</m:mo>
              <m:msub>
                <m:mi>W</m:mi>
                <m:mrow>
                  <m:mi>j</m:mi>
                  <m:mi>n</m:mi>
                </m:mrow>
              </m:msub>
              <m:mo>:</m:mo>
              <m:mspace width="0.277778em"/>
              <m:mn>1</m:mn>
              <m:mo>≤</m:mo>
              <m:mi>n</m:mi>
              <m:mo>}</m:mo>
            </m:mrow>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mtext>is</m:mtext>
            <m:mspace width="4.pt"/>
            <m:mtext>iid</m:mtext>
            <m:mspace width="4.pt"/>
            <m:mtext>for</m:mtext>
            <m:mspace width="4.pt"/>
            <m:mtext>each</m:mtext>
            <m:mspace width="0.277778em"/>
            <m:mi>j</m:mi>
            <m:mo>∈</m:mo>
            <m:mi mathvariant="bold">E</m:mi>
          </m:mrow>
        </m:math>
      </equation>

      <para id="id344873">We thus have</para>

      <equation id="id344879">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>P</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mrow>
                  <m:mi>n</m:mi>
                  <m:mo>+</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
              </m:msub>
              <m:mo>=</m:mo>
              <m:mi>k</m:mi>
              <m:mo>|</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>n</m:mi>
              </m:msub>
              <m:mo>=</m:mo>
              <m:mi>j</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mfenced separators="" open="{" close="">
              <m:mtable>
                <m:mtr>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mi>P</m:mi>
                      <m:mo>(</m:mo>
                      <m:msub>
                        <m:mi>W</m:mi>
                        <m:mrow>
                          <m:mi>j</m:mi>
                          <m:mi>n</m:mi>
                        </m:mrow>
                      </m:msub>
                      <m:mo>=</m:mo>
                      <m:mi>k</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mspace width="0.277778em"/>
                      <m:mtext>for</m:mtext>
                      <m:mspace width="0.277778em"/>
                      <m:mspace width="0.277778em"/>
                      <m:mn>0</m:mn>
                      <m:mo>≤</m:mo>
                      <m:mi>k</m:mi>
                      <m:mo>&lt;</m:mo>
                      <m:mi>M</m:mi>
                    </m:mrow>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mi>P</m:mi>
                      <m:mo>(</m:mo>
                      <m:msub>
                        <m:mi>W</m:mi>
                        <m:mi>j</m:mi>
                      </m:msub>
                      <m:mi>n</m:mi>
                      <m:mo>≥</m:mo>
                      <m:mi>M</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mspace width="0.277778em"/>
                      <m:mtext>for</m:mtext>
                      <m:mspace width="0.277778em"/>
                      <m:mspace width="0.277778em"/>
                      <m:mi>k</m:mi>
                      <m:mo>≥</m:mo>
                      <m:mi>M</m:mi>
                    </m:mrow>
                  </m:mtd>
                </m:mtr>
              </m:mtable>
            </m:mfenced>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mn>0</m:mn>
            <m:mo>≤</m:mo>
            <m:mi>j</m:mi>
            <m:mo>≤</m:mo>
            <m:mi>M</m:mi>
          </m:mrow>
        </m:math>
      </equation>

      <para id="id345059">With the aid of moment generating functions, one may determine distributions for</para>

      <equation id="id345065">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:msub>
              <m:mi>W</m:mi>
              <m:mn>1</m:mn>
            </m:msub>
            <m:mo>=</m:mo>
            <m:msub>
              <m:mi>Z</m:mi>
              <m:mn>1</m:mn>
            </m:msub>
            <m:mo>,</m:mo>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:msub>
              <m:mi>W</m:mi>
              <m:mn>2</m:mn>
            </m:msub>
            <m:mo>=</m:mo>
            <m:msub>
              <m:mi>Z</m:mi>
              <m:mn>1</m:mn>
            </m:msub>
            <m:mo>+</m:mo>
            <m:msub>
              <m:mi>Z</m:mi>
              <m:mn>2</m:mn>
            </m:msub>
            <m:mo>,</m:mo>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mo>⋯</m:mo>
            <m:mo>,</m:mo>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:msub>
              <m:mi>W</m:mi>
              <m:mi>M</m:mi>
            </m:msub>
            <m:mo>=</m:mo>
            <m:msub>
              <m:mi>Z</m:mi>
              <m:mn>1</m:mn>
            </m:msub>
            <m:mo>+</m:mo>
            <m:mo>⋯</m:mo>
            <m:mo>+</m:mo>
            <m:msub>
              <m:mi>Z</m:mi>
              <m:mi>M</m:mi>
            </m:msub>
          </m:mrow>
        </m:math>
      </equation>

      <para id="id345179">These calculations are implemented in an m-procedure called <emphasis effect="italics">branchp</emphasis>.  We simply need the distribution for the iid <m:math overflow="scroll"><m:msub><m:mi>Z</m:mi><m:mrow><m:mi>i</m:mi><m:mi>n</m:mi></m:mrow></m:msub></m:math>.</para>

      <code id="id345209" display="block">% file branchp.m
% Calculates transition matrix for a simple branching
% process with specified maximum population.
disp('Do not forget zero probabilities for missing values of Z')
PZ = input('Enter PROBABILITIES for individuals  ');
M  = input('Enter maximum allowable population  ');
mz = length(PZ) - 1;
EZ = dot(0:mz,PZ);
disp(['The average individual propagation is ',num2str(EZ),])
P  = zeros(M+1,M+1);
Z  = zeros(M,M*mz+1);
k  = 0:M*mz;
a  = min(M,k);
z  = 1;
P(1,1) = 1;
for i = 1:M                 % Operation similar to genD
  z = conv(PZ,z);
  Z(i,1:i*mz+1) = z;
  [t,p] = csort(a,Z(i,:));
  P(i+1,:) = p;
end
disp('The transition matrix is P')
disp('To study the evolution of the process, call for branchdbn')
 
PZ = 0.01*[15 45 25 10 5];    % Probability distribution for individuals
branchp                       % Call for procedure
Do not forget zero probabilities for missing values of Z
Enter PROBABILITIES for individuals  PZ
Enter maximum allowable population  10
The average individual propagation is 1.45
The transition matrix is P
To study the evolution of the process, call for branchdbn
disp(P)                       % Optional display of generated P
  Columns 1 through 7
    1.0000         0         0         0         0         0         0
    0.1500    0.4500    0.2500    0.1000    0.0500         0         0
    0.0225    0.1350    0.2775    0.2550    0.1675    0.0950    0.0350
    0.0034    0.0304    0.1080    0.1991    0.2239    0.1879    0.1293
    0.0005    0.0061    0.0307    0.0864    0.1534    0.1910    0.1852
    0.0001    0.0011    0.0075    0.0284    0.0702    0.1227    0.1623
    0.0000    0.0002    0.0017    0.0079    0.0253    0.0579    0.1003
    0.0000    0.0000    0.0003    0.0020    0.0078    0.0222    0.0483
    0.0000    0.0000    0.0001    0.0005    0.0021    0.0074    0.0194
    0.0000    0.0000    0.0000    0.0001    0.0005    0.0022    0.0068
    0.0000    0.0000    0.0000    0.0000    0.0001    0.0006    0.0022
  Columns 8 through 11
         0         0         0         0
         0         0         0         0
    0.0100    0.0025         0         0
    0.0705    0.0315    0.0119    0.0043
    0.1481    0.0987    0.0559    0.0440
    0.1730    0.1545    0.1179    0.1625
    0.1381    0.1574    0.1528    0.3585
    0.0832    0.1179    0.1412    0.5771
    0.0406    0.0698    0.1010    0.7591
    0.0169    0.0345    0.0590    0.8799
    0.0062    0.0147    0.0294    0.9468
</code>

      <para id="id345770">Note that <m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mo>(</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mn>0</m:mn><m:mo>)</m:mo><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow></m:math>. If the population ever reaches zero, it is extinct and no
more births can occur. Also, if the maximum population (10 in this case) is reached,
there is a high probability of returning to that value and very small probability of
becoming extinct (reaching zero state).</para>
      </example>


<example id="fs-id7291503"><title>Inventory problem (continued)</title>

<para id="id345830">In this case,</para>

      <equation id="id345833">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>g</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>j</m:mi>
              <m:mo>,</m:mo>
              <m:msub>
                <m:mi>D</m:mi>
                <m:mrow>
                  <m:mi>n</m:mi>
                  <m:mo>+</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
              </m:msub>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mfenced separators="" open="{" close="">
              <m:mtable>
                <m:mtr>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mo movablelimits="true" form="prefix">max</m:mo>
                      <m:mo>{</m:mo>
                      <m:mi>M</m:mi>
                      <m:mo>-</m:mo>
                      <m:msub>
                        <m:mi>D</m:mi>
                        <m:mrow>
                          <m:mi>n</m:mi>
                          <m:mo>+</m:mo>
                          <m:mn>1</m:mn>
                        </m:mrow>
                      </m:msub>
                      <m:mo>,</m:mo>
                      <m:mspace width="0.166667em"/>
                      <m:mn>0</m:mn>
                      <m:mo>}</m:mo>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mspace width="0.277778em"/>
                      <m:mtext>for</m:mtext>
                      <m:mspace width="0.277778em"/>
                      <m:mspace width="0.277778em"/>
                      <m:mn>0</m:mn>
                      <m:mo>≤</m:mo>
                      <m:mi>j</m:mi>
                      <m:mo>&lt;</m:mo>
                      <m:mi>m</m:mi>
                    </m:mrow>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mo movablelimits="true" form="prefix">max</m:mo>
                      <m:mo>{</m:mo>
                      <m:mi>j</m:mi>
                      <m:mo>-</m:mo>
                      <m:msub>
                        <m:mi>D</m:mi>
                        <m:mrow>
                          <m:mi>n</m:mi>
                          <m:mo>+</m:mo>
                          <m:mn>1</m:mn>
                        </m:mrow>
                      </m:msub>
                      <m:mo>,</m:mo>
                      <m:mspace width="0.166667em"/>
                      <m:mn>0</m:mn>
                      <m:mo>}</m:mo>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mspace width="0.277778em"/>
                      <m:mtext>for</m:mtext>
                      <m:mspace width="0.277778em"/>
                      <m:mspace width="0.277778em"/>
                      <m:mi>m</m:mi>
                      <m:mo>≤</m:mo>
                      <m:mi>j</m:mi>
                      <m:mo>≤</m:mo>
                      <m:mi>M</m:mi>
                    </m:mrow>
                  </m:mtd>
                </m:mtr>
              </m:mtable>
            </m:mfenced>
          </m:mrow>
        </m:math>
      </equation>

      <para id="id346016">
        <emphasis effect="italics">Numerical example</emphasis>
      </para>
 
     <equation id="id346025">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>m</m:mi>
            <m:mo>=</m:mo>
            <m:mn>1</m:mn>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mi>M</m:mi>
            <m:mo>=</m:mo>
            <m:mn>3</m:mn>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:msub>
              <m:mi>D</m:mi>
              <m:mi>n</m:mi>
            </m:msub>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mtext>is</m:mtext>
            <m:mspace width="4.pt"/>
            <m:mtext>Poisson</m:mtext>
            <m:mspace width="4.pt"/>
            <m:mtext>(1)</m:mtext>
          </m:mrow>
        </m:math>
      </equation>

      <para id="id346102">To simplify writing, use <emphasis effect="italics">D</emphasis> for <emphasis effect="italics">D<sub>n</sub></emphasis>. Because of the invariance with <emphasis effect="italics">n</emphasis>, set</para>
      
<equation id="id346140">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>P</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mrow>
                  <m:mi>n</m:mi>
                  <m:mo>+</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
              </m:msub>
              <m:mo>=</m:mo>
              <m:mi>k</m:mi>
              <m:mo>|</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>n</m:mi>
              </m:msub>
              <m:mo>=</m:mo>
              <m:mi>j</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mi>p</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>j</m:mi>
              <m:mo>,</m:mo>
              <m:mi>k</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mi>P</m:mi>
            <m:mrow>
              <m:mo>[</m:mo>
              <m:mi>g</m:mi>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>j</m:mi>
                <m:mo>,</m:mo>
                <m:mspace width="0.166667em"/>
                <m:msub>
                  <m:mi>D</m:mi>
                  <m:mrow>
                    <m:mi>n</m:mi>
                    <m:mo>+</m:mo>
                    <m:mn>1</m:mn>
                  </m:mrow>
                </m:msub>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mo>=</m:mo>
              <m:mi>k</m:mi>
              <m:mo>]</m:mo>
            </m:mrow>
          </m:mrow>
        </m:math>
      </equation>

      <para id="id346246">The various cases yield</para>

      <para id="id346252">
        <m:math overflow="scroll">
          <m:mrow>
            <m:mi>g</m:mi>
            <m:mo>(</m:mo>
            <m:mn>0</m:mn>
            <m:mo>,</m:mo>
            <m:mspace width="0.166667em"/>
            <m:mi>D</m:mi>
            <m:mo>)</m:mo>
            <m:mo>=</m:mo>
            <m:mo movablelimits="true" form="prefix">max</m:mo>
            <m:mo>{</m:mo>
            <m:mn>3</m:mn>
            <m:mo>-</m:mo>
            <m:mi>D</m:mi>
            <m:mo>,</m:mo>
            <m:mspace width="0.166667em"/>
            <m:mn>0</m:mn>
            <m:mo>}</m:mo>
          </m:mrow>
        </m:math>
      </para>

      <list id="fs-id8272636" list-type="bulleted" bullet-style="none"><item><m:math overflow="scroll"><m:mrow><m:mi>g</m:mi><m:mo>(</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>D</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:math> iff <m:math overflow="scroll"><m:mrow><m:mi>D</m:mi><m:mo>≥</m:mo><m:mn>3</m:mn></m:mrow></m:math> implies <m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mo>(</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mn>0</m:mn><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>P</m:mi><m:mo>(</m:mo><m:mi>D</m:mi><m:mo>≥</m:mo><m:mn>3</m:mn><m:mo>)</m:mo></m:mrow></m:math></item>
 
     <item><m:math overflow="scroll"><m:mrow><m:mi>g</m:mi><m:mo>(</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>D</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow></m:math> iff <m:math overflow="scroll"><m:mrow><m:mi>D</m:mi><m:mo>=</m:mo><m:mn>2</m:mn></m:mrow></m:math> implies <m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mo>(</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mn>1</m:mn><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>P</m:mi><m:mo>(</m:mo><m:mi>D</m:mi><m:mo>=</m:mo><m:mn>2</m:mn><m:mo>)</m:mo></m:mrow></m:math></item>

      <item><m:math overflow="scroll"><m:mrow><m:mi>g</m:mi><m:mo>(</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>D</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mn>2</m:mn></m:mrow></m:math> iff <m:math overflow="scroll"><m:mrow><m:mi>D</m:mi><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow></m:math> implies <m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mo>(</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mn>2</m:mn><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>P</m:mi><m:mo>(</m:mo><m:mi>D</m:mi><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:math></item>

      <item><m:math overflow="scroll"><m:mrow><m:mi>g</m:mi><m:mo>(</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>D</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mn>3</m:mn></m:mrow></m:math> iff <m:math overflow="scroll"><m:mrow><m:mi>D</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:math> implies <m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mo>(</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mn>3</m:mn><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>P</m:mi><m:mo>(</m:mo><m:mi>D</m:mi><m:mo>=</m:mo><m:mn>0</m:mn><m:mo>)</m:mo></m:mrow></m:math></item>

</list>

      <para id="id346648">
        <m:math overflow="scroll">
          <m:mrow>
            <m:mi>g</m:mi>
            <m:mo>(</m:mo>
            <m:mn>1</m:mn>
            <m:mo>,</m:mo>
            <m:mspace width="0.166667em"/>
            <m:mi>D</m:mi>
            <m:mo>)</m:mo>
            <m:mo>=</m:mo>
            <m:mo movablelimits="true" form="prefix">max</m:mo>
            <m:mo>{</m:mo>
            <m:mn>1</m:mn>
            <m:mo>-</m:mo>
            <m:mi>D</m:mi>
            <m:mo>,</m:mo>
            <m:mspace width="0.277778em"/>
            <m:mn>0</m:mn>
            <m:mo>}</m:mo>
          </m:mrow>
        </m:math>
      </para>

      <list id="fs-id8263325" list-type="bulleted" bullet-style="none"><item><m:math overflow="scroll"><m:mrow><m:mi>g</m:mi><m:mo>(</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>D</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:math> iff <m:math overflow="scroll"><m:mrow><m:mi>D</m:mi><m:mo>≥</m:mo><m:mn>1</m:mn></m:mrow></m:math> implies <m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mo>(</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mn>0</m:mn><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>P</m:mi><m:mo>(</m:mo><m:mi>D</m:mi><m:mo>≥</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:math></item>
      
<item>               <m:math overflow="scroll"><m:mrow><m:mi>g</m:mi><m:mo>(</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>D</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow></m:math> iff <m:math overflow="scroll"><m:mrow><m:mi>D</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:math> implies <m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mo>(</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mn>1</m:mn><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>P</m:mi><m:mo>(</m:mo><m:mi>D</m:mi><m:mo>=</m:mo><m:mn>0</m:mn><m:mo>)</m:mo></m:mrow></m:math></item>

      <item>               <m:math overflow="scroll"><m:mrow><m:mi>g</m:mi><m:mo>(</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>D</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mn>2</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mn>3</m:mn></m:mrow></m:math> is impossible</item>
</list>

      <para id="id346913">
        <m:math overflow="scroll">
          <m:mrow>
            <m:mi>g</m:mi>
            <m:mo>(</m:mo>
            <m:mn>2</m:mn>
            <m:mo>,</m:mo>
            <m:mspace width="0.166667em"/>
            <m:mi>D</m:mi>
            <m:mo>)</m:mo>
            <m:mo>=</m:mo>
            <m:mo movablelimits="true" form="prefix">max</m:mo>
            <m:mo>{</m:mo>
            <m:mn>2</m:mn>
            <m:mo>-</m:mo>
            <m:mi>D</m:mi>
            <m:mo>,</m:mo>
            <m:mspace width="0.166667em"/>
            <m:mn>0</m:mn>
            <m:mo>}</m:mo>
          </m:mrow>
        </m:math>
      </para>
 
     <list id="fs-id8724593" list-type="bulleted" bullet-style="none"><item>               <m:math overflow="scroll"><m:mrow><m:mi>g</m:mi><m:mo>(</m:mo><m:mn>2</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>D</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:math> iff <m:math overflow="scroll"><m:mrow><m:mi>D</m:mi><m:mo>≥</m:mo><m:mn>2</m:mn></m:mrow></m:math> implies <m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mo>(</m:mo><m:mn>2</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mn>0</m:mn><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>P</m:mi><m:mo>(</m:mo><m:mi>D</m:mi><m:mo>≥</m:mo><m:mn>2</m:mn><m:mo>)</m:mo></m:mrow></m:math></item>

      <item>               <m:math overflow="scroll"><m:mrow><m:mi>g</m:mi><m:mo>(</m:mo><m:mn>2</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>D</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow></m:math> iff <m:math overflow="scroll"><m:mrow><m:mi>D</m:mi><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow></m:math> implies <m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mo>(</m:mo><m:mn>2</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mn>1</m:mn><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>P</m:mi><m:mo>(</m:mo><m:mi>D</m:mi><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:math></item>

      <item>               <m:math overflow="scroll"><m:mrow><m:mi>g</m:mi><m:mo>(</m:mo><m:mn>2</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>D</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mn>2</m:mn></m:mrow></m:math> iff <m:math overflow="scroll"><m:mrow><m:mi>D</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:math> implies <m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mo>(</m:mo><m:mn>2</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mn>2</m:mn><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>P</m:mi><m:mo>(</m:mo><m:mi>D</m:mi><m:mo>=</m:mo><m:mn>0</m:mn><m:mo>)</m:mo></m:mrow></m:math></item>

      <item>               <m:math overflow="scroll"><m:mrow><m:mi>g</m:mi><m:mo>(</m:mo><m:mn>2</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>D</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mn>3</m:mn></m:mrow></m:math> is impossible</item>

</list>

      <para id="id347256"><m:math overflow="scroll"><m:mrow><m:mi>g</m:mi><m:mo>(</m:mo><m:mn>3</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>D</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mo movablelimits="true" form="prefix">max</m:mo><m:mo>{</m:mo><m:mn>3</m:mn><m:mo>-</m:mo><m:mi>D</m:mi><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mn>0</m:mn><m:mo>}</m:mo><m:mo>=</m:mo><m:mi>g</m:mi><m:mo>(</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>D</m:mi><m:mo>)</m:mo></m:mrow></m:math> so that <m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mo>(</m:mo><m:mn>3</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>k</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>p</m:mi><m:mo>(</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>k</m:mi><m:mo>)</m:mo></m:mrow></m:math></para>

      <para id="id347369">The various probabilities for <emphasis effect="italics">D</emphasis> may be obtained from a table (or may be
calculated easily with cpoisson) to give the transition probability matrix</para>

      <equation id="id347383">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi mathvariant="bold">P</m:mi>
            <m:mo>=</m:mo>
            <m:mfenced separators="" open="[" close="]">
              <m:mtable>
                <m:mtr>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>0803</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>1839</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>3679</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>3679</m:mn>
                    </m:mrow>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>6321</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>3679</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mn>0</m:mn>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mn>0</m:mn>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>2642</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>3679</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>3679</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mn>0</m:mn>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>0803</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>1839</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>3679</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>3679</m:mn>
                    </m:mrow>
                  </m:mtd>
                </m:mtr>
              </m:mtable>
            </m:mfenced>
          </m:mrow>
        </m:math>
      </equation>

      <para id="id347571">The calculations are carried out “by hand” in this case, to exhibit the nature of
the calculations. This is a standard problem in inventory theory, involving costs and
rewards.
An m-procedure <emphasis effect="italics">inventory1</emphasis> has been written to implement the function <emphasis effect="italics">g</emphasis>.</para>

      <code id="id347597" display="block">% file inventory1.m
% Version of 1/27/97
% Data for transition probability calculations
% for (m,M) inventory policy
M  = input('Enter value M of maximum stock  ');
m  = input('Enter value m of reorder point  ');
Y  = input('Enter row vector of demand values  ');
PY = input('Enter demand probabilities  ');
states = 0:M;
ms = length(states);
my = length(Y);
% Calculations for determining P
[y,s] = meshgrid(Y,states);
T  =  max(0,M-y).*(s &lt; m) + max(0,s-y).*(s &gt;= m);
P  = zeros(ms,ms);
for i = 1:ms
   [a,b] = meshgrid(T(i,:),states);
   P(i,:) = PY*(a==b)';
end
P
</code>

      <para id="id347810">We consider the case <m:math overflow="scroll"><m:mrow><m:mi>M</m:mi><m:mo>=</m:mo><m:mn>5</m:mn></m:mrow></m:math>, the reorder point
<m:math overflow="scroll"><m:mrow><m:mi>m</m:mi><m:mo>=</m:mo><m:mn>3</m:mn></m:mrow></m:math>, and demand is Poisson (3). We approximate the Poisson distribution with values
up to 20.</para>

      <code id="id347846" display="block">inventory1
Enter value M of maximum stock  5             % Maximum stock
Enter value m of reorder point  3             % Reorder point
Enter row vector of demand values  0:20       % Truncated set of demand values
Enter demand probabilities  ipoisson(3,0:20)  % Demand probabilities
P =
    0.1847    0.1680    0.2240    0.2240    0.1494    0.0498
    0.1847    0.1680    0.2240    0.2240    0.1494    0.0498
    0.1847    0.1680    0.2240    0.2240    0.1494    0.0498
    0.5768    0.2240    0.1494    0.0498         0         0
    0.3528    0.2240    0.2240    0.1494    0.0498         0
    0.1847    0.1680    0.2240    0.2240    0.1494    0.0498
</code>

      </example>


<example id="fs-id2497259">
      <title>  Remaining lifetime (continued)</title>

      <para id="id347984"><m:math overflow="scroll"><m:mrow><m:mi>g</m:mi><m:mo>(</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>Y</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>Y</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:math>, so that <m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mo>(</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>k</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>P</m:mi><m:mo>(</m:mo><m:mi>Y</m:mi><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>=</m:mo><m:mi>k</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>P</m:mi><m:mo>(</m:mo><m:mi>Y</m:mi><m:mo>=</m:mo><m:mi>k</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:math></para>

      <para id="id348080"><m:math overflow="scroll"><m:mrow><m:mi>g</m:mi><m:mo>(</m:mo><m:mi>j</m:mi><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>Y</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>j</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:math> for <m:math overflow="scroll"><m:mrow><m:mi>j</m:mi><m:mo>≥</m:mo><m:mn>1</m:mn></m:mrow></m:math>, so that <m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mrow><m:mo>(</m:mo><m:mi>j</m:mi><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>k</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:msub><m:mi>δ</m:mi><m:mrow><m:mi>j</m:mi><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mi>k</m:mi></m:mrow></m:msub></m:mrow></m:math> for <m:math overflow="scroll"><m:mrow><m:mi>j</m:mi><m:mo>≥</m:mo><m:mn>1</m:mn></m:mrow></m:math></para>

      <para id="id348186">The resulting transition probability matrix is</para>

      <equation id="id348190">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi mathvariant="bold">P</m:mi>
            <m:mo>=</m:mo>
            <m:mfenced separators="" open="[" close="]">
              <m:mtable>
                <m:mtr>
                  <m:mtd>
                    <m:msub>
                      <m:mi>p</m:mi>
                      <m:mn>1</m:mn>
                    </m:msub>
                  </m:mtd>
                  <m:mtd>
                    <m:msub>
                      <m:mi>p</m:mi>
                      <m:mn>2</m:mn>
                    </m:msub>
                  </m:mtd>
                  <m:mtd>
                    <m:msub>
                      <m:mi>p</m:mi>
                      <m:mn>3</m:mn>
                    </m:msub>
                  </m:mtd>
                  <m:mtd>
                    <m:mo>⋯</m:mo>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd>
                    <m:mn>1</m:mn>
                  </m:mtd>
                  <m:mtd>
                    <m:mn>0</m:mn>
                  </m:mtd>
                  <m:mtd>
                    <m:mn>0</m:mn>
                  </m:mtd>
                  <m:mtd>
                    <m:mo>⋯</m:mo>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd>
                    <m:mn>0</m:mn>
                  </m:mtd>
                  <m:mtd>
                    <m:mn>1</m:mn>
                  </m:mtd>
                  <m:mtd>
                    <m:mn>0</m:mn>
                  </m:mtd>
                  <m:mtd>
                    <m:mo>⋯</m:mo>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd>
                    <m:mo>⋯</m:mo>
                  </m:mtd>
                  <m:mtd/>
                  <m:mtd/>
                  <m:mtd>
                    <m:mo>⋯</m:mo>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd>
                    <m:mo>⋯</m:mo>
                  </m:mtd>
                  <m:mtd/>
                  <m:mtd/>
                  <m:mtd>
                    <m:mo>⋯</m:mo>
                  </m:mtd>
                </m:mtr>
              </m:mtable>
            </m:mfenced>
          </m:mrow>
        </m:math>
      </equation>

      <para id="id348292">The matrix is an infinite matrix, unless <emphasis effect="italics">Y</emphasis> is simple. If the range of
<emphasis effect="italics">Y</emphasis> is <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mn>2</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mo>⋯</m:mo><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>M</m:mi><m:mo>}</m:mo></m:mrow></m:math> then the state space <emphasis effect="bold">E</emphasis> is <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mn>1</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mo>⋯</m:mo><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>M</m:mi><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>}</m:mo></m:mrow></m:math>.</para>

      </example>



      <para id="id348422">Various properties of conditional independence, particularly <link document="m24003" target-id="uid9">(CI9)</link>, <link document="m24003" target-id="uid10">(CI10)</link>, and <link document="m24003" target-id="uid12">(CI12)</link>,
may be used to establish the following. The immediate future <m:math overflow="scroll"><m:msub><m:mi>X</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub></m:math> may be
replaced by any <emphasis effect="italics">finite future</emphasis><m:math overflow="scroll"><m:msub><m:mi>U</m:mi><m:mrow><m:mi>n</m:mi><m:mo>,</m:mo><m:mi>n</m:mi><m:mo>+</m:mo><m:mi>p</m:mi></m:mrow></m:msub></m:math> and the present <emphasis effect="italics">X<sub>n</sub></emphasis>
may be replaced by any <emphasis effect="italics">extended present</emphasis><m:math overflow="scroll"><m:msub><m:mi>U</m:mi><m:mrow><m:mi>m</m:mi><m:mo>,</m:mo><m:mi>n</m:mi></m:mrow></m:msub></m:math>. Some
results of abstract measure theory show that the finite future <m:math overflow="scroll"><m:msub><m:mi>U</m:mi><m:mrow><m:mi>n</m:mi><m:mo>,</m:mo><m:mi>n</m:mi><m:mo>+</m:mo><m:mi>p</m:mi></m:mrow></m:msub></m:math>
may be replaced by the <emphasis effect="italics">entire future </emphasis><emphasis effect="italics">U<sup>n</sup></emphasis>. Thus, we may assert</para>

      <para id="id348558">
        <emphasis effect="italics">Extended Markov property</emphasis>
      </para>

      <para id="id348565"><emphasis effect="italics">X<sub>N</sub></emphasis> is Markov iff</para>

      <equation id="id348583">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:msup>
              <m:mtext>(M</m:mtext>
              <m:mo>*</m:mo>
            </m:msup>
            <m:mrow>
              <m:mo>)</m:mo>
              <m:mspace width="0.277778em"/>
              <m:mspace width="0.277778em"/>
              <m:mspace width="0.277778em"/>
              <m:mrow>
                <m:mo>{</m:mo>
                <m:msup>
                  <m:mi>U</m:mi>
                  <m:mi>n</m:mi>
                </m:msup>
                <m:mo>,</m:mo>
                <m:mspace width="0.166667em"/>
                <m:msub>
                  <m:mi>U</m:mi>
                  <m:mi>m</m:mi>
                </m:msub>
                <m:mo>}</m:mo>
              </m:mrow>
              <m:mspace width="0.166667em"/>
              <m:mi> ci </m:mi>
              <m:mspace width="0.166667em"/>
              <m:mo>|</m:mo>
            </m:mrow>
            <m:msub>
              <m:mi>U</m:mi>
              <m:mrow>
                <m:mi>m</m:mi>
                <m:mo>,</m:mo>
                <m:mi>n</m:mi>
              </m:mrow>
            </m:msub>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mo>∀</m:mo>
            <m:mspace width="0.277778em"/>
            <m:mn>0</m:mn>
            <m:mo>≤</m:mo>
            <m:mi>m</m:mi>
            <m:mo>≤</m:mo>
            <m:mi>n</m:mi>
          </m:mrow>
        </m:math>
      </equation>

      <para id="id348694">— <m:math overflow="scroll"><m:mo>□</m:mo></m:math></para>
    

    <para id="fs-id8747268"><emphasis effect="bold">The Chapman-Kolmogorov equation and the transition matrix</emphasis></para>

      <para id="id348719">As a special case of the extended Markov property, we have</para>

      <equation id="id348723">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mrow>
              <m:mo>{</m:mo>
              <m:msup>
                <m:mi>U</m:mi>
                <m:mrow>
                  <m:mi>n</m:mi>
                  <m:mo>+</m:mo>
                  <m:mi>k</m:mi>
                </m:mrow>
              </m:msup>
              <m:mo>,</m:mo>
              <m:mspace width="0.166667em"/>
              <m:msub>
                <m:mi>U</m:mi>
                <m:mi>n</m:mi>
              </m:msub>
              <m:mo>}</m:mo>
            </m:mrow>
            <m:mrow>
              <m:mspace width="0.166667em"/>
              <m:mi> ci </m:mi>
              <m:mspace width="0.166667em"/>
              <m:mo>|</m:mo>
            </m:mrow>
            <m:msub>
              <m:mi>X</m:mi>
              <m:mrow>
                <m:mi>n</m:mi>
                <m:mo>+</m:mo>
                <m:mi>k</m:mi>
              </m:mrow>
            </m:msub>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mtext>for</m:mtext>
            <m:mspace width="4.pt"/>
            <m:mtext>all</m:mtext>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mi>n</m:mi>
            <m:mo>≥</m:mo>
            <m:mn>0</m:mn>
            <m:mo>,</m:mo>
            <m:mspace width="0.277778em"/>
            <m:mi>k</m:mi>
            <m:mo>,</m:mo>
            <m:mo>≥</m:mo>
            <m:mn>1</m:mn>
          </m:mrow>
        </m:math>
      </equation>

      <para id="id348834">Setting <m:math overflow="scroll"><m:mrow><m:mi>g</m:mi><m:mrow><m:mo>(</m:mo><m:msup><m:mi>U</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mi>k</m:mi></m:mrow></m:msup><m:mo>,</m:mo><m:msub><m:mi>X</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mi>k</m:mi></m:mrow></m:msub><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:msub><m:mi>X</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mi>k</m:mi><m:mo>+</m:mo><m:mi>m</m:mi></m:mrow></m:msub></m:mrow></m:math> and <m:math overflow="scroll"><m:mrow><m:mi>h</m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>U</m:mi><m:mi>n</m:mi></m:msub><m:mo>,</m:mo><m:msub><m:mi>X</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mi>k</m:mi></m:mrow></m:msub><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:msub><m:mi>X</m:mi><m:mi>n</m:mi></m:msub></m:mrow></m:math> in <link document="m24003" target-id="uid9">(CI9)</link>, we get</para>

      <equation id="id348950">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mrow>
              <m:mo>{</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mrow>
                  <m:mi>n</m:mi>
                  <m:mo>+</m:mo>
                  <m:mi>k</m:mi>
                  <m:mo>+</m:mo>
                  <m:mi>m</m:mi>
                </m:mrow>
              </m:msub>
              <m:mo>,</m:mo>
              <m:mspace width="0.166667em"/>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>n</m:mi>
              </m:msub>
              <m:mo>}</m:mo>
            </m:mrow>
            <m:mrow>
              <m:mspace width="0.166667em"/>
              <m:mi> ci </m:mi>
              <m:mspace width="0.166667em"/>
              <m:mo>|</m:mo>
            </m:mrow>
            <m:msub>
              <m:mi>X</m:mi>
              <m:mrow>
                <m:mi>n</m:mi>
                <m:mo>+</m:mo>
                <m:mi>k</m:mi>
              </m:mrow>
            </m:msub>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mtext>for</m:mtext>
            <m:mspace width="4.pt"/>
            <m:mtext>all</m:mtext>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mi>n</m:mi>
            <m:mo>≥</m:mo>
            <m:mn>0</m:mn>
            <m:mo>,</m:mo>
            <m:mspace width="0.277778em"/>
            <m:mi>k</m:mi>
            <m:mo>,</m:mo>
            <m:mspace width="0.166667em"/>
            <m:mi>m</m:mi>
            <m:mo>≥</m:mo>
            <m:mn>1</m:mn>
          </m:mrow>
        </m:math>
      </equation>

      <para id="id349070">By the iterated conditioning rule <link document="m24003" target-id="uid8">(CI9)</link> for conditional independence, it
follows that</para>
      <equation id="id349076">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>C</m:mi>
              <m:mi>K</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mi>E</m:mi>
            <m:mrow>
              <m:mo>[</m:mo>
              <m:mi>g</m:mi>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:msub>
                  <m:mi>X</m:mi>
                  <m:mrow>
                    <m:mi>n</m:mi>
                    <m:mo>+</m:mo>
                    <m:mi>k</m:mi>
                    <m:mo>+</m:mo>
                    <m:mi>m</m:mi>
                  </m:mrow>
                </m:msub>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mo>|</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>n</m:mi>
              </m:msub>
              <m:mo>]</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mi>E</m:mi>
            <m:mrow>
              <m:mo>{</m:mo>
              <m:mi>E</m:mi>
              <m:mrow>
                <m:mo>[</m:mo>
                <m:mi>g</m:mi>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:msub>
                    <m:mi>X</m:mi>
                    <m:mrow>
                      <m:mi>n</m:mi>
                      <m:mo>+</m:mo>
                      <m:mi>k</m:mi>
                      <m:mo>+</m:mo>
                      <m:mi>m</m:mi>
                    </m:mrow>
                  </m:msub>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:mo>|</m:mo>
                <m:msub>
                  <m:mi>X</m:mi>
                  <m:mrow>
                    <m:mi>n</m:mi>
                    <m:mo>+</m:mo>
                    <m:mi>k</m:mi>
                  </m:mrow>
                </m:msub>
                <m:mo>]</m:mo>
              </m:mrow>
              <m:mo>|</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>n</m:mi>
              </m:msub>
              <m:mo>}</m:mo>
            </m:mrow>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mo>∀</m:mo>
            <m:mspace width="0.277778em"/>
            <m:mi>n</m:mi>
            <m:mo>≥</m:mo>
            <m:mn>0</m:mn>
            <m:mo>,</m:mo>
            <m:mspace width="0.277778em"/>
            <m:mi>k</m:mi>
            <m:mo>,</m:mo>
            <m:mspace width="0.166667em"/>
            <m:mi>m</m:mi>
            <m:mo>≥</m:mo>
            <m:mn>1</m:mn>
          </m:mrow>
        </m:math>
      </equation>

      <para id="id349260">This is the <emphasis effect="italics">Chapman-Kolmogorov equation</emphasis>, which plays a central
role in the study of Markov sequences. For a discrete state space <emphasis effect="bold">E</emphasis>, with</para>

      <equation id="id349284">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>P</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>n</m:mi>
              </m:msub>
              <m:mo>=</m:mo>
              <m:mi>j</m:mi>
              <m:mo>|</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>m</m:mi>
              </m:msub>
              <m:mo>=</m:mo>
              <m:mi>i</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:msub>
              <m:mi>p</m:mi>
              <m:mrow>
                <m:mi>m</m:mi>
                <m:mo>,</m:mo>
                <m:mi>n</m:mi>
              </m:mrow>
            </m:msub>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>i</m:mi>
              <m:mo>,</m:mo>
              <m:mspace width="0.166667em"/>
              <m:mi>j</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
          </m:mrow>
        </m:math>
      </equation>

      <para id="id349356">this equation takes the form</para>

      <equation id="id349362">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>C</m:mi>
              <m:msup>
                <m:mi>K</m:mi>
                <m:mo>'</m:mo>
              </m:msup>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:msub>
              <m:mi>p</m:mi>
              <m:mrow>
                <m:mi>m</m:mi>
                <m:mo>,</m:mo>
                <m:mi>q</m:mi>
              </m:mrow>
            </m:msub>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>i</m:mi>
              <m:mo>,</m:mo>
              <m:mspace width="0.166667em"/>
              <m:mi>k</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:munder>
              <m:mo>∑</m:mo>
              <m:mrow>
                <m:mi>j</m:mi>
                <m:mo>∈</m:mo>
                <m:mi mathvariant="bold">E</m:mi>
              </m:mrow>
            </m:munder>
            <m:msub>
              <m:mi>p</m:mi>
              <m:mrow>
                <m:mi>m</m:mi>
                <m:mo>,</m:mo>
                <m:mi>n</m:mi>
              </m:mrow>
            </m:msub>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>i</m:mi>
              <m:mo>,</m:mo>
              <m:mspace width="0.166667em"/>
              <m:mi>j</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:msub>
              <m:mi>p</m:mi>
              <m:mrow>
                <m:mi>n</m:mi>
                <m:mo>,</m:mo>
                <m:mi>q</m:mi>
              </m:mrow>
            </m:msub>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>j</m:mi>
              <m:mo>,</m:mo>
              <m:mspace width="0.166667em"/>
              <m:mi>k</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mn>0</m:mn>
            <m:mo>≤</m:mo>
            <m:mi>m</m:mi>
            <m:mo>&lt;</m:mo>
            <m:mi>n</m:mi>
            <m:mo>&lt;</m:mo>
            <m:mi>q</m:mi>
          </m:mrow>
        </m:math>
      </equation>

      <para id="id349531">To see that this is so, consider</para>

      <equation id="id349537">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>P</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>q</m:mi>
              </m:msub>
              <m:mo>=</m:mo>
              <m:mi>k</m:mi>
              <m:mo>|</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>m</m:mi>
              </m:msub>
              <m:mo>=</m:mo>
              <m:mi>i</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mi>E</m:mi>
            <m:mrow>
              <m:mo>[</m:mo>
              <m:msub>
                <m:mi>I</m:mi>
                <m:mrow>
                  <m:mo>{</m:mo>
                  <m:mi>k</m:mi>
                  <m:mo>}</m:mo>
                </m:mrow>
              </m:msub>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:msub>
                  <m:mi>X</m:mi>
                  <m:mi>q</m:mi>
                </m:msub>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mo>|</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>m</m:mi>
              </m:msub>
              <m:mo>=</m:mo>
              <m:mi>i</m:mi>
              <m:mo>]</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mi>E</m:mi>
            <m:mrow>
              <m:mo>{</m:mo>
              <m:mi>E</m:mi>
              <m:mrow>
                <m:mo>[</m:mo>
                <m:msub>
                  <m:mi>I</m:mi>
                  <m:mrow>
                    <m:mo>{</m:mo>
                    <m:mi>k</m:mi>
                    <m:mo>}</m:mo>
                  </m:mrow>
                </m:msub>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:msub>
                    <m:mi>X</m:mi>
                    <m:mi>q</m:mi>
                  </m:msub>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:mo>|</m:mo>
                <m:msub>
                  <m:mi>X</m:mi>
                  <m:mi>n</m:mi>
                </m:msub>
                <m:mo>]</m:mo>
              </m:mrow>
              <m:mo>|</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>m</m:mi>
              </m:msub>
              <m:mo>=</m:mo>
              <m:mi>i</m:mi>
              <m:mo>}</m:mo>
            </m:mrow>
          </m:mrow>
        </m:math>
      </equation>

      <equation id="id349696">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mo>=</m:mo>
            <m:munder>
              <m:mo>∑</m:mo>
              <m:mi>j</m:mi>
            </m:munder>
            <m:mi>E</m:mi>
            <m:mrow>
              <m:mo>[</m:mo>
              <m:msub>
                <m:mi>I</m:mi>
                <m:mrow>
                  <m:mo>{</m:mo>
                  <m:mi>k</m:mi>
                  <m:mo>}</m:mo>
                </m:mrow>
              </m:msub>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:msub>
                  <m:mi>X</m:mi>
                  <m:mi>q</m:mi>
                </m:msub>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mo>|</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>n</m:mi>
              </m:msub>
              <m:mo>=</m:mo>
              <m:mi>j</m:mi>
              <m:mo>]</m:mo>
            </m:mrow>
            <m:msub>
              <m:mi>p</m:mi>
              <m:mrow>
                <m:mi>m</m:mi>
                <m:mo>,</m:mo>
                <m:mi>n</m:mi>
              </m:mrow>
            </m:msub>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>i</m:mi>
              <m:mo>,</m:mo>
              <m:mspace width="0.166667em"/>
              <m:mi>j</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:munder>
              <m:mo>∑</m:mo>
              <m:mi>j</m:mi>
            </m:munder>
            <m:msub>
              <m:mi>p</m:mi>
              <m:mrow>
                <m:mi>n</m:mi>
                <m:mo>,</m:mo>
                <m:mi>q</m:mi>
              </m:mrow>
            </m:msub>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>j</m:mi>
              <m:mo>,</m:mo>
              <m:mspace width="0.166667em"/>
              <m:mi>k</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:msub>
              <m:mi>p</m:mi>
              <m:mrow>
                <m:mi>m</m:mi>
                <m:mo>,</m:mo>
                <m:mi>n</m:mi>
              </m:mrow>
            </m:msub>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>i</m:mi>
              <m:mo>,</m:mo>
              <m:mspace width="0.166667em"/>
              <m:mi>j</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
          </m:mrow>
        </m:math>
      </equation>

      <para id="id349857">
        <emphasis effect="italics">Homogeneous case</emphasis>
      </para>

      <para id="id349866">For this case, we may put <m:math overflow="scroll"><m:mrow><m:mo>(</m:mo><m:mi>C</m:mi><m:msup><m:mi>K</m:mi><m:mo>'</m:mo></m:msup><m:mo>)</m:mo></m:mrow></m:math> in a useful matrix form.
The conditional probabilities <emphasis effect="italics">p<sup>m</sup></emphasis> of the form</para>

      <equation id="id349906">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:msup>
              <m:mi>p</m:mi>
              <m:mi>m</m:mi>
            </m:msup>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>i</m:mi>
              <m:mo>,</m:mo>
              <m:mspace width="0.166667em"/>
              <m:mi>k</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mi>P</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mrow>
                  <m:mi>n</m:mi>
                  <m:mo>+</m:mo>
                  <m:mi>m</m:mi>
                </m:mrow>
              </m:msub>
              <m:mo>=</m:mo>
              <m:mi>k</m:mi>
              <m:mo>|</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>n</m:mi>
              </m:msub>
              <m:mo>=</m:mo>
              <m:mi>i</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="4.pt"/>
            <m:mtext>invariant</m:mtext>
            <m:mspace width="4.pt"/>
            <m:mtext>in</m:mtext>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mi>n</m:mi>
          </m:mrow>
        </m:math>
      </equation>

      <para id="id350015">are known as the <emphasis effect="italics">m-step transition probabilities</emphasis>. The
Chapman-Kolmogorov equation in this case becomes</para>

      <equation id="id350027">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>C</m:mi>
              <m:msup>
                <m:mi>K</m:mi>
                <m:mrow>
                  <m:mo>'</m:mo>
                  <m:mo>'</m:mo>
                </m:mrow>
              </m:msup>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:msup>
              <m:mi>p</m:mi>
              <m:mrow>
                <m:mi>m</m:mi>
                <m:mo>+</m:mo>
                <m:mi>n</m:mi>
              </m:mrow>
            </m:msup>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>i</m:mi>
              <m:mo>,</m:mo>
              <m:mspace width="0.166667em"/>
              <m:mi>k</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:munder>
              <m:mo>∑</m:mo>
              <m:mrow>
                <m:mi>j</m:mi>
                <m:mo>∈</m:mo>
                <m:mi mathvariant="bold">E</m:mi>
              </m:mrow>
            </m:munder>
            <m:msup>
              <m:mi>p</m:mi>
              <m:mi>m</m:mi>
            </m:msup>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>i</m:mi>
              <m:mo>,</m:mo>
              <m:mspace width="0.166667em"/>
              <m:mi>j</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:msup>
              <m:mi>p</m:mi>
              <m:mi>n</m:mi>
            </m:msup>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>j</m:mi>
              <m:mo>,</m:mo>
              <m:mspace width="0.166667em"/>
              <m:mi>k</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mo>∀</m:mo>
            <m:mspace width="0.277778em"/>
            <m:mi>i</m:mi>
            <m:mo>,</m:mo>
            <m:mspace width="0.166667em"/>
            <m:mi>j</m:mi>
            <m:mo>∈</m:mo>
            <m:mi mathvariant="bold">E</m:mi>
          </m:mrow>
        </m:math>
      </equation>

      <para id="id350195">In terms of the <emphasis effect="italics">m-step transition matrix </emphasis><m:math overflow="scroll"><m:mrow><m:msup><m:mi mathvariant="bold">P</m:mi><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>=</m:mo><m:mrow><m:mo>[</m:mo><m:msup><m:mi>p</m:mi><m:mi>m</m:mi></m:msup><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>,</m:mo><m:mi>k</m:mi><m:mo>)</m:mo></m:mrow><m:mo>]</m:mo></m:mrow></m:mrow></m:math>,
this set of sums is equivalent to the matrix product</para>

      <equation id="id350260">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>C</m:mi>
              <m:msup>
                <m:mi>K</m:mi>
                <m:mrow>
                  <m:mo>'</m:mo>
                  <m:mo>'</m:mo>
                </m:mrow>
              </m:msup>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:msup>
              <m:mi mathvariant="bold">P</m:mi>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>m</m:mi>
                <m:mo>+</m:mo>
                <m:mi>n</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
            </m:msup>
            <m:mo>=</m:mo>
            <m:msup>
              <m:mi mathvariant="bold">P</m:mi>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>m</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
            </m:msup>
            <m:msup>
              <m:mi mathvariant="bold">P</m:mi>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>n</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
            </m:msup>
          </m:mrow>
        </m:math>
      </equation>

      <para id="id350353">Now</para>

      <equation id="id350358">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:msup>
              <m:mi mathvariant="bold">P</m:mi>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mn>2</m:mn>
                <m:mo>)</m:mo>
              </m:mrow>
            </m:msup>
            <m:mo>=</m:mo>
            <m:msup>
              <m:mi mathvariant="bold">P</m:mi>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mn>1</m:mn>
                <m:mo>)</m:mo>
              </m:mrow>
            </m:msup>
            <m:msup>
              <m:mi mathvariant="bold">P</m:mi>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mn>1</m:mn>
                <m:mo>)</m:mo>
              </m:mrow>
            </m:msup>
            <m:mo>=</m:mo>
            <m:mi mathvariant="bold">P</m:mi>
            <m:mi mathvariant="bold">P</m:mi>
            <m:mo>=</m:mo>
            <m:msup>
              <m:mi mathvariant="bold">P</m:mi>
              <m:mn>2</m:mn>
            </m:msup>
            <m:mo>,</m:mo>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:msup>
              <m:mi mathvariant="bold">P</m:mi>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mn>3</m:mn>
                <m:mo>)</m:mo>
              </m:mrow>
            </m:msup>
            <m:mo>=</m:mo>
            <m:msup>
              <m:mi mathvariant="bold">P</m:mi>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mn>2</m:mn>
                <m:mo>)</m:mo>
              </m:mrow>
            </m:msup>
            <m:msup>
              <m:mi mathvariant="bold">P</m:mi>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mn>1</m:mn>
                <m:mo>)</m:mo>
              </m:mrow>
            </m:msup>
            <m:mo>=</m:mo>
            <m:msup>
              <m:mi mathvariant="bold">P</m:mi>
              <m:mn>3</m:mn>
            </m:msup>
            <m:mo>,</m:mo>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mtext>etc.</m:mtext>
          </m:mrow>
        </m:math>
      </equation>

      <para id="id350524">A simple inductive argument based on <m:math overflow="scroll"><m:mrow><m:mo>(</m:mo><m:mi>C</m:mi><m:msup><m:mi>K</m:mi><m:mrow><m:mo>'</m:mo><m:mo>'</m:mo></m:mrow></m:msup><m:mo>)</m:mo></m:mrow></m:math> establishes</para>

      <para id="id350555">
        <emphasis effect="italics">The product rule for transition matrices</emphasis>
      </para>

      <para id="id350562">The <emphasis effect="italics">m</emphasis>-step probability matrix <m:math overflow="scroll"><m:mrow><m:msup><m:mi mathvariant="bold">P</m:mi><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>=</m:mo><m:msup><m:mi mathvariant="bold">P</m:mi><m:mi>m</m:mi></m:msup></m:mrow></m:math>, the <emphasis effect="italics">m</emphasis>th power of the
transition matrix <emphasis effect="bold">P</emphasis></para>

      <para id="id350628">— <m:math overflow="scroll"><m:mo>□</m:mo></m:math></para>


<example id="fs-id6564273">
      <title>  The inventory problem (continued)</title>

      <para id="id350651">For the inventory problem in <link target-id="fs-id7291503"/>, the three-step transition probability
matrix <m:math overflow="scroll"><m:msup><m:mi mathvariant="bold">P</m:mi><m:mrow><m:mo>(</m:mo><m:mn>3</m:mn><m:mo>)</m:mo></m:mrow></m:msup></m:math> is obtained by raising <emphasis effect="bold">P</emphasis> to the third power to get</para>

      <equation id="id350688">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:msup>
              <m:mi mathvariant="bold">P</m:mi>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mn>3</m:mn>
                <m:mo>)</m:mo>
              </m:mrow>
            </m:msup>
            <m:mo>=</m:mo>
            <m:msup>
              <m:mi mathvariant="bold">P</m:mi>
              <m:mn>3</m:mn>
            </m:msup>
            <m:mo>=</m:mo>
            <m:mfenced separators="" open="[" close="]">
              <m:mtable>
                <m:mtr>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>2930</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>2917</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>2629</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>1524</m:mn>
                    </m:mrow>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>2619</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>2730</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>2753</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>1898</m:mn>
                    </m:mrow>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>2993</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>2854</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>2504</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>1649</m:mn>
                    </m:mrow>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>2930</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>2917</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>2629</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>1524</m:mn>
                    </m:mrow>
                  </m:mtd>
                </m:mtr>
              </m:mtable>
            </m:mfenced>
          </m:mrow>
        </m:math>
      </equation>

      <para id="id350915">— <m:math overflow="scroll"><m:mo>□</m:mo></m:math></para>

</example>

      <para id="id350932">We consider next the state probabilities for the various stages. That is,
we examine the distributions for the various <emphasis effect="italics">X<sub>n</sub></emphasis>, letting
<m:math overflow="scroll"><m:mrow><m:msub><m:mi>p</m:mi><m:mi>k</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>n</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mi>P</m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>X</m:mi><m:mi>n</m:mi></m:msub><m:mo>=</m:mo><m:mi>k</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> for each <m:math overflow="scroll"><m:mrow><m:mi>k</m:mi><m:mo>∈</m:mo><m:mi mathvariant="bold">E</m:mi></m:mrow></m:math>. To simplify writing,
we consider a finite state space <m:math overflow="scroll"><m:mrow><m:mi mathvariant="bold">E</m:mi><m:mo>=</m:mo><m:mo>{</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mo>⋯</m:mo><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>M</m:mi><m:mo>}</m:mo></m:mrow></m:math>. We use
<m:math overflow="scroll"><m:mrow><m:mi>π</m:mi><m:mo>(</m:mo><m:mi>n</m:mi><m:mo>)</m:mo></m:mrow></m:math> for the <emphasis effect="italics">row</emphasis> matrix</para>

      <equation id="id351069">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>π</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>n</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mo>[</m:mo>
            <m:msub>
              <m:mi>p</m:mi>
              <m:mn>1</m:mn>
            </m:msub>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>n</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:msub>
              <m:mi>p</m:mi>
              <m:mn>2</m:mn>
            </m:msub>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>n</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mspace width="0.277778em"/>
            <m:mo>⋯</m:mo>
            <m:mspace width="0.277778em"/>
            <m:msub>
              <m:mi>p</m:mi>
              <m:mi>M</m:mi>
            </m:msub>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>n</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>]</m:mo>
          </m:mrow>
        </m:math>
      </equation>

      <para id="id351156">As a consequence of the product rule, we have</para>

      <para id="id351162">
        <emphasis effect="italics">Probability distributions for any period</emphasis>
      </para>

      <para id="id351168">For a homogeneous Markov sequence, the distribution for any
<emphasis effect="italics">X<sub>n</sub></emphasis> is determined by the initial distribution (i.e., for <emphasis effect="italics">X<sub>0</sub></emphasis>) and the transition
probability matrix <emphasis effect="bold">P</emphasis>.</para>

      <para id="id351215">VERIFICATION</para>

      <para id="id351218">Suppose the homogeneous sequence <emphasis effect="italics">X<sub>N</sub></emphasis> has finite state-space
<m:math overflow="scroll"><m:mrow><m:mi mathvariant="bold">E</m:mi><m:mo>=</m:mo><m:mo>{</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mn>2</m:mn><m:mo>,</m:mo><m:mo>⋯</m:mo><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>M</m:mi><m:mo>}</m:mo></m:mrow></m:math>. For any <m:math overflow="scroll"><m:mrow><m:mi>n</m:mi><m:mo>≥</m:mo><m:mn>0</m:mn></m:mrow></m:math>, let <m:math overflow="scroll"><m:mrow><m:msub><m:mi>p</m:mi><m:mi>j</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>n</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mi>P</m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>X</m:mi><m:mi>n</m:mi></m:msub><m:mo>=</m:mo><m:mi>j</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> for each <m:math overflow="scroll"><m:mrow><m:mi>j</m:mi><m:mo>∈</m:mo><m:mi mathvariant="bold">E</m:mi></m:mrow></m:math>. Put</para>

      <equation id="id351357">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>π</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>n</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mo>[</m:mo>
            <m:msub>
              <m:mi>p</m:mi>
              <m:mn>1</m:mn>
            </m:msub>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>n</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:msub>
              <m:mi>p</m:mi>
              <m:mn>2</m:mn>
            </m:msub>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>n</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mspace width="0.277778em"/>
            <m:mo>⋯</m:mo>
            <m:mspace width="0.277778em"/>
            <m:msub>
              <m:mi>p</m:mi>
              <m:mi>M</m:mi>
            </m:msub>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>n</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>]</m:mo>
          </m:mrow>
        </m:math>
      </equation>

      <para id="id351444">Then</para>

      <list id="fs-id8627214" list-type="bulleted" bullet-style="none"><item>              <m:math overflow="scroll"><m:mrow><m:mi>π</m:mi>
<m:mo>(</m:mo><m:mn>0</m:mn><m:mo>)</m:mo><m:mo>=</m:mo></m:mrow></m:math> the initial probability distribution</item>

      <item>              <m:math overflow="scroll"><m:mrow><m:mi>π</m:mi><m:mo>(</m:mo><m:mn>1</m:mn><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>π</m:mi><m:mo>(</m:mo><m:mn>0</m:mn><m:mo>)</m:mo><m:mi mathvariant="bold">P</m:mi></m:mrow></m:math></item>

      <item>                   .....</item>

      <item>              <m:math overflow="scroll"><m:mrow><m:mi>π</m:mi><m:mrow><m:mo>(</m:mo><m:mi>n</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mi>π</m:mi><m:mrow><m:mo>(</m:mo><m:mi>n</m:mi><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow><m:mi mathvariant="bold">P</m:mi><m:mo>=</m:mo><m:mi>π</m:mi><m:mrow><m:mo>(</m:mo><m:mn>0</m:mn><m:mo>)</m:mo></m:mrow><m:msup><m:mi mathvariant="bold">P</m:mi><m:mrow><m:mo>(</m:mo><m:mi>n</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>=</m:mo><m:mi>π</m:mi><m:mrow><m:mo>(</m:mo><m:mn>0</m:mn><m:mo>)</m:mo></m:mrow><m:msup><m:mi mathvariant="bold">P</m:mi><m:mi>n</m:mi></m:msup><m:mo>=</m:mo></m:mrow></m:math> the <emphasis effect="italics">n</emphasis>th-period distribution</item>
</list>

      <para id="id351621">The last expression is an immediate consequence of the product rule.</para>

      <para id="id351625">— <m:math overflow="scroll"><m:mo>□</m:mo></m:math></para>


<example id="fs-id3190349">
      <title>  Inventory problem (continued)</title>

      <para id="id351647">In the inventory system for Examples <link target-id="fs-id1171020808877">3</link>, <link target-id="fs-id7291503">7</link> and <link target-id="fs-id6564273">9</link>, suppose the initial stock is
<m:math overflow="scroll"><m:mrow><m:mi>M</m:mi><m:mo>=</m:mo><m:mn>3</m:mn></m:mrow></m:math>. This means that</para>

      <equation id="id351666">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>π</m:mi>
            <m:mo>(</m:mo>
            <m:mn>0</m:mn>
            <m:mo>)</m:mo>
            <m:mo>=</m:mo>
            <m:mo>[</m:mo>
            <m:mn>0</m:mn>
            <m:mspace width="0.277778em"/>
            <m:mn>0</m:mn>
            <m:mspace width="0.277778em"/>
            <m:mn>0</m:mn>
            <m:mspace width="0.277778em"/>
            <m:mn>1</m:mn>
            <m:mo>]</m:mo>
          </m:mrow>
        </m:math>
      </equation>

      <para id="id351708">The product of <m:math overflow="scroll"><m:mrow><m:mi>π</m:mi><m:mo>(</m:mo><m:mn>0</m:mn><m:mo>)</m:mo></m:mrow></m:math> and <emphasis effect="italics">P<sup>3</sup></emphasis> is the fourth row
of <emphasis effect="italics">P<sup>3</sup></emphasis>, so that the distribution for <emphasis effect="italics">X<sub>3</sub></emphasis> is</para>

      <equation id="id351779">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>π</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mn>3</m:mn>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mo>[</m:mo>
            <m:msub>
              <m:mi>p</m:mi>
              <m:mn>0</m:mn>
            </m:msub>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mn>3</m:mn>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:msub>
              <m:mi>p</m:mi>
              <m:mn>1</m:mn>
            </m:msub>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mn>3</m:mn>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:msub>
              <m:mi>p</m:mi>
              <m:mn>2</m:mn>
            </m:msub>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mn>3</m:mn>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:msub>
              <m:mi>p</m:mi>
              <m:mn>3</m:mn>
            </m:msub>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mn>3</m:mn>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>]</m:mo>
            <m:mo>=</m:mo>
            <m:mrow>
              <m:mo>[</m:mo>
              <m:mn>0</m:mn>
              <m:mo>.</m:mo>
              <m:mn>2930</m:mn>
              <m:mspace width="0.277778em"/>
              <m:mspace width="0.277778em"/>
              <m:mn>0</m:mn>
              <m:mo>.</m:mo>
              <m:mn>2917</m:mn>
              <m:mspace width="0.277778em"/>
              <m:mspace width="0.277778em"/>
              <m:mn>0</m:mn>
              <m:mo>.</m:mo>
              <m:mn>2629</m:mn>
              <m:mspace width="0.277778em"/>
              <m:mspace width="0.277778em"/>
              <m:mn>0</m:mn>
              <m:mo>.</m:mo>
              <m:mn>1524</m:mn>
              <m:mo>]</m:mo>
            </m:mrow>
          </m:mrow>
        </m:math>
      </equation>

      <para id="id351937">Thus, given a stock of <m:math overflow="scroll"><m:mrow><m:mi>M</m:mi><m:mo>=</m:mo><m:mn>3</m:mn></m:mrow></m:math> at startup, the probability
is 0.2917 that <m:math overflow="scroll"><m:mrow><m:msub><m:mi>X</m:mi><m:mn>3</m:mn></m:msub><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow></m:math>. This is the probability of one unit
in stock at the end of period number three.</para>

      </example>


      <para id="id351993">
        <emphasis effect="italics">Remarks</emphasis>
      </para>

      <list id="fs-id8620031">

        <item id="uid7">A similar treatment shows that for the nonhomogeneous case
the distribution at any stage is determined by the initial distribution and
the class of one-step transition matrices. In the nonhomogeneous case,
transition probabilities <m:math overflow="scroll"><m:mrow><m:msub><m:mi>p</m:mi><m:mrow><m:mi>n</m:mi><m:mo>,</m:mo><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>j</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> depend on the stage <emphasis effect="italics">n</emphasis>.
</item>

        <item id="uid8">A discrete-parameter Markov process, or Markov
sequence, is characterized by the fact that each member <m:math overflow="scroll"><m:msub><m:mi>X</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub></m:math> of
the sequence is conditioned by the value of the previous member of the
sequence. This one-step stochastic linkage has made it customary to
refer to a Markov sequence as a <emphasis effect="italics">Markov chain</emphasis>. In the
discrete-parameter Markov case, we use the terms <emphasis effect="italics">process, sequence,</emphasis>
or <emphasis effect="italics">chain</emphasis> interchangeably.
</item>

      </list>

      <para id="id352116">
        <emphasis effect="bold">The transition diagram and the transition matrix</emphasis>
      </para>

      <para id="id352124">The previous examples suggest that a Markov chain is a dynamic system, evolving in time.
On the other hand, the stochastic behavior of a homogeneous chain is determined completely
by the probability distribution for the initial state and the
one-step transition probabilities <m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>j</m:mi><m:mo>)</m:mo></m:mrow></m:math> as presented in the transition matrix <emphasis effect="bold">P</emphasis>.
The time-invariant transition matrix may convey a static impression of the system.
However, a simple geometric representation, known as the <emphasis effect="italics">transition diagram</emphasis>,
makes it possible to link the unchanging structure, represented by the
transition matrix, with the dynamics of the evolving system behavior.</para>

      <para id="id352175"><emphasis effect="bold">Definition</emphasis>. A <emphasis effect="italics">transition diagram</emphasis> for a homogeneous Markov
chain is a linear graph with one node for each state and one directed
edge for each possible one-step transition between states (nodes).</para>

      <para id="id352189">We ignore, as essentially impossible, any transition which has zero transition
probability. Thus, the edges on the diagram correspond to
positive one-step transition probabilities between the nodes connected.
Since for some pair <m:math overflow="scroll"><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>,</m:mo><m:mi>j</m:mi><m:mo>)</m:mo></m:mrow></m:math> of states, we may have <m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>,</m:mo><m:mi>j</m:mi><m:mo>)</m:mo><m:mo>&gt;</m:mo><m:mn>0</m:mn></m:mrow></m:math>
but <m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mo>(</m:mo><m:mi>j</m:mi><m:mo>,</m:mo><m:mi>i</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:math>, we may have a
connecting edge between two nodes in one direction, but none in the other. <emphasis effect="italics">The
system can be viewed as an object jumping from state to state (node to
node) at the successive transition times</emphasis>. As we follow the <emphasis effect="italics">trajectory</emphasis>
of this object, we achieve a sense of the evolution of the system.</para>
     

<example id="fs-id1171029920812">
 <title>  Transition diagram for inventory example</title>

      <para id="id352294">Consider, again, the transition matrix <emphasis effect="bold">P</emphasis> for the inventory problem (rounded
to three decimals).</para>

      <equation id="id352310">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi mathvariant="bold">P</m:mi>
            <m:mo>=</m:mo>
            <m:mfenced separators="" open="[" close="]">
              <m:mtable>
                <m:mtr>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>080</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>184</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>368</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>368</m:mn>
                    </m:mrow>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>632</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>368</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mn>0</m:mn>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mn>0</m:mn>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>264</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>368</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>368</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mn>0</m:mn>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>080</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>184</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>368</m:mn>
                    </m:mrow>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mn>0</m:mn>
                      <m:mo>.</m:mo>
                      <m:mn>368</m:mn>
                    </m:mrow>
                  </m:mtd>
                </m:mtr>
              </m:mtable>
            </m:mfenced>
          </m:mrow>
        </m:math>
      </equation>

      <para id="id352495">Figure 1 shows the transition diagram for this system. At each node corresponding to
one of the possible states, the <emphasis effect="italics">state value</emphasis> is shown. In this example, the state value is one
less than the state number. For convenience, we refer to the node for state <m:math overflow="scroll"><m:mrow><m:mi>k</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:math>, which has
state value <emphasis effect="italics">k</emphasis>, as node <emphasis effect="italics">k</emphasis>. If the state value is zero, there are four possibilities: remain in
that condition with probability 0.080; move to node 1 with probability 0.184; move to node 2
with probability 0.368; or move to node 3 with probability 0.368. These
are represented by the “self loop” and a directed edge to each of the nodes representing
states. Each of these directed edges is marked with the (conditional) transition probability.
On the other hand, probabilities of reaching state value 0 from each of the others is
represented by directed edges into the node for state value 0. A similar situation holds for each
other node. Note that the probabilities on edges leaving a node (including a self
loop) must total to one, since these correspond to the transition probability distribution
from that node. There is no directed edge from the node 2 to node 3, since the probability
of a transition from value 2 to value 3 is zero. Similary, there is no directed
edge from node 1 to either node 2 or node 3.</para>
      </example>



      <figure id="uid9"><media id="uid9_media" alt="Figure one is a transition diagram comprised of multiple shapes all labeled with values from the transition matrix P in  Example 11. The most central shape in the figure is a symmetric triangle with longest side horizontal to the figure and two sides of equal length meeting above the horizontal base. There are small circles located on the triangle at four points, three of which at the vertices, and the fourth at the center of the base of the triangle. From the top vertex of the triangle, and reading them in a clockwise direction, the small circles are labeled 0, 1, 2, and 3. These circles also divide the base of the triangle into two parts, effectively creating four sections of the triangle. The two sections of the base are labeled 0.368. The side of the triangle on the left is also labeled 0.368. The right side of the triangle is labeled 0.632. On each of these four sections of the triangle is a small arrow. On the two sections of the base, the arrows are pointing to the right. On the right side of the triangle, the arrow is pointing towards the top-left of the page. On the left side of the triangle, the arrow is pointing to the bottom-left of the page. Considered together, these four arrows all indicate motion in a counter-clockwise direction. On the outside of the triangle, at each of its vertices, and connected to the small circles, are larger circles. Additionally, there is a circle below the triangle, connected to the small circle located on the triangle in the middle of its base. The large circle connected to small circle 0 is labeled,  0.080. The large circle connected to small circle 1 is labeled, 0.368. The large circle connected to small circle 2 is labeled, 0.368. The large circle connected to small circle 3 is labeled, 0.368. All four large circles include a small arrow indicating movement in the clockwise direction. Inside the triangle are two curved lines, bowed in different directions, and connecting small circle 0 to small circle 2. The bowed line to the left is labeled, 0.264, and contains a small arrow pointed upward. The bowed line to the right is labeled 0.368, and contains a small arrow pointed downward. There is a curved line connecting small circle 3 to small circle 0. It is bowed inward, labeled 0.080, and contains a small arrow pointed to the top-right towards small circle 0. There is another curved line connecting small circle 0 to small circle 1. It is bowed inward, labeled 0.184, and it contains an arrow pointing to the bottom-right towards small circle 1. There is a final curved line connecting circle 3 to circle 1. It is bowed inward, labeled 0.184, and it contains a small arrow pointing to the right towards the direction of small circle 1.">
          <image mime-type="image/png" src="../../media/fig16_3_1.png" id="uid9_onlineimage" width="445"><!-- NOTE: attribute width changes image size online (pixels). original width is 445. --></image>
          <image for="pdf" mime-type="application/postscript" src="../../media/fig16_3_1.eps" id="uid9_printimage" print-width="4in">
            <!--NOTE: attribute width changes image size in printed PDF (if specified in .tex file)-->
          </image>
        </media>
        
      <caption>Transition diagram for the inventory system of <link target-id="fs-id1171029920812"/>.</caption></figure>

      <para id="id352578">There is a one-one relation between the transition diagram and the transition
matrix <emphasis effect="bold">P</emphasis>. The transition diagram not only aids in visualizing the
dynamic evolution of a chain, but also displays certain structural properties.
Often a chain may be decomposed usefully into subchains. Questions of
<emphasis effect="italics">communication</emphasis> and <emphasis effect="italics">recurrence</emphasis> may be answered in terms of the
transition diagram. Some subsets of states are essentially <emphasis effect="italics">closed</emphasis>, in the
sense that if the system arrives at any one state in the subset it can
never reach a state outside the subset. Periodicities can sometimes be seen,
although it is usually easier to use the diagram to show that periodicities
cannot occur.</para>

      <para id="id352616">
        <emphasis effect="bold">Classification of states</emphasis>
      </para>

      <para id="id352623">Many important characteristics of a Markov chain can be studied by considering
the number of visits to an arbitrarily chosen, but fixed, state.</para>

      <para id="id352629"><emphasis effect="bold">Definition</emphasis>.  For a fixed state <emphasis effect="italics">j</emphasis>, let</para>

      <list id="fs-id8776554" list-type="bulleted" bullet-style="none"><item id="uid10"><label/><m:math overflow="scroll"><m:mrow><m:msub><m:mi>T</m:mi><m:mn>1</m:mn></m:msub><m:mo>=</m:mo></m:mrow></m:math> the time (stage number) of the first visit to state <emphasis effect="italics">j</emphasis> (after
the initial period).
</item>

        <item id="uid11"><label/><m:math overflow="scroll"><m:mrow><m:msub><m:mi>F</m:mi><m:mi>k</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>,</m:mo><m:mi>j</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mi>P</m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>T</m:mi><m:mi>i</m:mi></m:msub><m:mo>=</m:mo><m:mi>k</m:mi><m:mo>|</m:mo><m:msub><m:mi>X</m:mi><m:mn>0</m:mn></m:msub><m:mo>=</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math>, the probability of reaching state

<emphasis effect="italics">j</emphasis> for the first time from state <emphasis effect="italics">i</emphasis> in <emphasis effect="italics">k</emphasis> steps.
</item>

        <item id="uid12"><label/><m:math overflow="scroll"><m:mstyle scriptlevel="0" displaystyle="true"><m:mrow><m:mi>F</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>,</m:mo><m:mi>j</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mi>P</m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>T</m:mi><m:mi>i</m:mi></m:msub><m:mo>&lt;</m:mo><m:mi>∞</m:mi><m:mo>|</m:mo><m:msub><m:mi>X</m:mi><m:mn>0</m:mn></m:msub><m:mo>=</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>k</m:mi><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow><m:mi>∞</m:mi></m:munderover><m:msub><m:mi>F</m:mi><m:mi>k</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>j</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mstyle></m:math>, the probability of ever reaching
state <emphasis effect="italics">j</emphasis> from state <emphasis effect="italics">i</emphasis>.
</item>
      </list>

      <para id="id352928">A number of important theorems may be developed for <emphasis effect="italics">F<sub>k</sub></emphasis> and <emphasis effect="italics">F</emphasis>, although we
do not develop them in this treatment. We simply quote them as needed.
An important classification of states is made in terms of <emphasis effect="italics">F</emphasis>.</para>

      <para id="id352963"><emphasis effect="bold">Definition</emphasis>.  State <emphasis effect="italics">j</emphasis> is said to be <emphasis effect="italics">transient</emphasis> iff <m:math overflow="scroll"><m:mrow><m:mi>F</m:mi><m:mo>(</m:mo><m:mi>j</m:mi><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>j</m:mi><m:mo>)</m:mo><m:mo>&lt;</m:mo><m:mn>1</m:mn></m:mrow></m:math>,</para>

      <para id="id353014">                 and is said to be <emphasis effect="italics">recurrent</emphasis> iff <m:math overflow="scroll"><m:mrow><m:mi>F</m:mi><m:mo>(</m:mo><m:mi>j</m:mi><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>j</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow></m:math>.</para>

      <para id="id353054"><emphasis effect="italics">Remark</emphasis>.  If the state space <emphasis effect="bold">E</emphasis> is infinite, recurrent states fall into one
of two subclasses: positive or null. Only the positive case is common in
the infinite case, and that is the only possible case for systems with finite state space.</para>

      <para id="id353075">Sometimes there is a regularity in the structure of a Markov sequence that results
in periodicities.</para>

      <para id="id353079"><emphasis effect="bold">Definition</emphasis>.  For state <emphasis effect="italics">j</emphasis>, let</para>

      <equation id="id353096">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>δ</m:mi>
            <m:mo>=</m:mo>
            <m:mtext>greatest</m:mtext>
            <m:mspace width="4.pt"/>
            <m:mtext>common</m:mtext>
            <m:mspace width="4.pt"/>
            <m:mtext>denominator</m:mtext>
            <m:mspace width="4.pt"/>
            <m:mtext>of</m:mtext>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mo>{</m:mo>
            <m:mi>n</m:mi>
            <m:mo>:</m:mo>
            <m:msup>
              <m:mi>p</m:mi>
              <m:mi>n</m:mi>
            </m:msup>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>j</m:mi>
              <m:mo>,</m:mo>
              <m:mspace width="0.166667em"/>
              <m:mi>j</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>&gt;</m:mo>
            <m:mn>0</m:mn>
            <m:mo>}</m:mo>
          </m:mrow>
        </m:math>
      </equation>

      <para id="id353171">If <m:math overflow="scroll"><m:mrow><m:mi>δ</m:mi><m:mo>&gt;</m:mo><m:mn>1</m:mn></m:mrow></m:math>, then state <emphasis effect="italics">j</emphasis> is <emphasis effect="italics">periodic</emphasis> with <emphasis effect="italics">period</emphasis><emphasis effect="italics"> δ</emphasis>;  otherwise, state <emphasis effect="italics">j</emphasis> is <emphasis effect="italics">aperiodic</emphasis>.</para>

      <para id="id353235">Usually if there are any self loops in the transition diagram (positive probabilities
on the diagonal of the transition matrix <emphasis effect="bold">P</emphasis>) the system is aperiodic. <emphasis effect="italics">Unless stated
otherwise, we limit consideration to the aperiodic case.</emphasis></para>

      <para id="id353256"><emphasis effect="bold">Definition</emphasis>.  A state <emphasis effect="italics">j</emphasis> is called <emphasis effect="italics">ergodic</emphasis> iff it is positive, recurrent, and
aperiodic.</para>

      <para id="id353279">                 It is called <emphasis effect="italics">absorbing</emphasis> iff <m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mo>(</m:mo><m:mi>j</m:mi><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>j</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow></m:math>.</para>

      <para id="id353319">A recurrent state is one to which the system eventually returns, hence is visited an
infinity of times. If it is absorbing, then once it is reached it returns each step
(i.e., never leaves).</para>

      <para id="id353324">An arrow notation is used to indicate important relations between states.</para>
<para id="fs-id8637362"><emphasis effect="bold">Definition</emphasis>.  We say</para>
      <list id="fs-id8637371" list-type="bulleted" bullet-style="none"><item>      State <emphasis effect="italics">i</emphasis> reaches <emphasis effect="italics">j</emphasis>, denoted <m:math overflow="scroll"><m:mrow><m:mi>i</m:mi><m:mo>→</m:mo><m:mi>j</m:mi></m:mrow></m:math>, iff <m:math overflow="scroll"><m:mrow><m:msup><m:mi>p</m:mi><m:mi>n</m:mi></m:msup><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>j</m:mi><m:mo>)</m:mo></m:mrow><m:mo>&gt;</m:mo><m:mn>0</m:mn></m:mrow></m:math> for some
<m:math overflow="scroll"><m:mrow><m:mi>n</m:mi><m:mo>&gt;</m:mo><m:mn>0</m:mn></m:mrow></m:math>.</item>
  

    <item>      States <emphasis effect="italics">i</emphasis> and <emphasis effect="italics">j</emphasis> communicate, denoted <m:math overflow="scroll"><m:mrow><m:mi>i</m:mi><m:mo>↔</m:mo><m:mi>j</m:mi></m:mrow></m:math> iff both
<emphasis effect="italics">i</emphasis> reaches <emphasis effect="italics">j</emphasis> and <emphasis effect="italics">j</emphasis> reaches <emphasis effect="italics">i</emphasis>.</item>

</list>


      <para id="fs-id8760393">By including <emphasis effect="italics">j</emphasis> reaches <emphasis effect="italics">j</emphasis> in all cases, the relation <m:math overflow="scroll"><m:mo>↔</m:mo></m:math> is an
equivalence relation (i.e., is reflexive, transitive, and idempotent). With this
relationship, we can define important classes.</para>
    
  <para id="id353523"><emphasis effect="italics">Definition</emphasis>.  A class of states is <emphasis effect="italics">communicating</emphasis> iff every state in the
class may be reached from every other state in the class (i.e. every pair communicates).  A class is <emphasis effect="italics">closed</emphasis> if no state outside the class can be reached from within the
class.</para>

      <para id="id353543">The following important conditions are intuitive and may be established rigorously:</para>

      <list id="fs-id8598652" list-type="bulleted" bullet-style="none"><item>          <m:math overflow="scroll"><m:mrow><m:mi>i</m:mi><m:mo>↔</m:mo><m:mi>j</m:mi></m:mrow></m:math> implies <emphasis effect="italics">i</emphasis> is recurrent iff <emphasis effect="italics">j</emphasis> is recurrent</item>

      <item>          <m:math overflow="scroll"><m:mrow><m:mi>i</m:mi><m:mo>→</m:mo><m:mi>j</m:mi></m:mrow></m:math> and <emphasis effect="italics">i</emphasis> recurrent implies <m:math overflow="scroll"><m:mrow><m:mi>i</m:mi><m:mo>↔</m:mo><m:mi>j</m:mi></m:mrow></m:math></item>

      <item>          <m:math overflow="scroll"><m:mrow><m:mi>i</m:mi><m:mo>→</m:mo><m:mi>j</m:mi></m:mrow></m:math> and <emphasis effect="italics">i</emphasis> recurrent implies <emphasis effect="italics">j</emphasis> recurrent</item>
</list>

  
    <para id="fs-id8678573">
      <emphasis effect="bold"> Limit theorems for finite state space sequences</emphasis></para>

      <para id="id353673">The following propositions may be established for Markov sequences with finite state space:</para>
      

<list id="fs-id8788846">
        <item id="uid13">There are no null states, and not all states are transient.
</item>
        <item id="uid14">If a class of states is irreducible (i.e.,has no proper closed subsets), then

<list id="fs-id8790098" display="block" list-type="bulleted" bullet-style="dash"><item>All states are recurrent</item>

<item>All states are aperiodic <emphasis effect="italics">or</emphasis> all are periodic with the same period.</item>

<item>If a class <emphasis effect="italics">C</emphasis> is closed, irreducible, and <emphasis effect="italics">i</emphasis> is a transient state (necessarily not
in <emphasis effect="italics">C</emphasis>),
    <list id="eip-id1170651694963" list-type="bulleted" bullet-style="none"><item>then <m:math overflow="scroll"><m:mrow><m:mi>F</m:mi><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>j</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>F</m:mi><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>,</m:mo><m:mspace width="0.166667em"/><m:mi>k</m:mi><m:mo>)</m:mo></m:mrow></m:math> for all <m:math overflow="scroll"><m:mrow><m:mi>j</m:mi><m:mo>,</m:mo><m:mspace width="0.277778em"/><m:mi>k</m:mi><m:mo>∈</m:mo><m:mi>C</m:mi></m:mrow></m:math>.</item></list></item>
      </list>
</item>
</list>      
<para id="id353826">
        <emphasis effect="italics">A limit theorem</emphasis>
      </para>
      <para id="id353832">If the states in a Markov chain are ergodic (i.e., positive, recurrent, aperiodic), then</para>
      <equation id="id353836"><m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:munder>
              <m:mo movablelimits="true" form="prefix">lim</m:mo>
              <m:mi>n</m:mi>
            </m:munder>
            <m:msup>
              <m:mi>p</m:mi>
              <m:mi>n</m:mi>
            </m:msup>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>i</m:mi>
              <m:mo>,</m:mo>
              <m:mspace width="0.166667em"/>
              <m:mi>j</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:msub>
              <m:mi>π</m:mi>
              <m:mi>j</m:mi>
            </m:msub>
            <m:mo>&gt;</m:mo>
            <m:mn>0</m:mn>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:munderover>
              <m:mrow><m:mo>∑</m:mo></m:mrow>
              <m:mrow>
                <m:mi>j</m:mi>
                <m:mo>=</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
              <m:mi>M</m:mi>
            </m:munderover>
            <m:msub>
              <m:mi>π</m:mi>
              <m:mi>j</m:mi>
            </m:msub>
            <m:mo>=</m:mo>
            <m:mn>1</m:mn>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:msub>
              <m:mi>π</m:mi>
              <m:mi>j</m:mi>
            </m:msub>
            <m:mo>=</m:mo>
            <m:munderover>
              <m:mrow><m:mo>∑</m:mo></m:mrow>
              <m:mrow>
                <m:mi>i</m:mi>
                <m:mo>=</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
              <m:mi>M</m:mi>
            </m:munderover>
            <m:msub>
              <m:mi>π</m:mi>
              <m:mi>i</m:mi>
            </m:msub>
            <m:mi>p</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>i</m:mi>
              <m:mo>,</m:mo>
              <m:mspace width="0.166667em"/>
              <m:mi>j</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id354007">If, as above, we let</para>
      <equation id="id354013">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>π</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>n</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mrow>
              <m:mo>[</m:mo>
              <m:msub>
                <m:mi>p</m:mi>
                <m:mn>1</m:mn>
              </m:msub>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>n</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mspace width="0.277778em"/>
              <m:mspace width="0.277778em"/>
              <m:msub>
                <m:mi>p</m:mi>
                <m:mn>1</m:mn>
              </m:msub>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>n</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mspace width="0.277778em"/>
              <m:mo>⋯</m:mo>
              <m:mspace width="0.277778em"/>
              <m:msub>
                <m:mi>p</m:mi>
                <m:mi>M</m:mi>
              </m:msub>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>n</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mo>]</m:mo>
            </m:mrow>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mtext>so</m:mtext>
            <m:mspace width="4.pt"/>
            <m:mtext>that</m:mtext>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mspace width="0.277778em"/>
            <m:mi>π</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>n</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mi>π</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mn>0</m:mn>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:msup>
              <m:mi mathvariant="bold">P</m:mi>
              <m:mi>n</m:mi>
            </m:msup>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id354160">the result above may be written</para>
      <equation id="id354166">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>π</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>n</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mi>π</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mn>0</m:mn>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:msup>
              <m:mi mathvariant="bold">P</m:mi>
              <m:mi>n</m:mi>
            </m:msup>
            <m:mo>→</m:mo>
            <m:mi>π</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mn>0</m:mn>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:msub>
              <m:mi mathvariant="bold">P</m:mi>
              <m:mn>0</m:mn>
            </m:msub>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id354229">where</para>
      <equation id="id354235">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:msub>
              <m:mi mathvariant="bold">P</m:mi>
              <m:mn>0</m:mn>
            </m:msub>
            <m:mo>=</m:mo>
            <m:mfenced separators="" open="[" close="]">
              <m:mtable>
                <m:mtr>
                  <m:mtd columnalign="left">
                    <m:msub>
                      <m:mi>π</m:mi>
                      <m:mn>1</m:mn>
                    </m:msub>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:msub>
                      <m:mi>π</m:mi>
                      <m:mn>2</m:mn>
                    </m:msub>
                  </m:mtd>
                  <m:mtd>
                    <m:mo>⋯</m:mo>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:msub>
                      <m:mi>π</m:mi>
                      <m:mi>m</m:mi>
                    </m:msub>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd columnalign="left">
                    <m:msub>
                      <m:mi>π</m:mi>
                      <m:mn>1</m:mn>
                    </m:msub>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:msub>
                      <m:mi>π</m:mi>
                      <m:mn>2</m:mn>
                    </m:msub>
                  </m:mtd>
                  <m:mtd>
                    <m:mo>⋯</m:mo>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:msub>
                      <m:mi>π</m:mi>
                      <m:mi>m</m:mi>
                    </m:msub>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd columnalign="left">
                    <m:mo>⋯</m:mo>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mo>⋯</m:mo>
                  </m:mtd>
                  <m:mtd>
                    <m:mo>⋯</m:mo>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mo>⋯</m:mo>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd columnalign="left">
                    <m:msub>
                      <m:mi>π</m:mi>
                      <m:mn>1</m:mn>
                    </m:msub>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:msub>
                      <m:mi>π</m:mi>
                      <m:mn>2</m:mn>
                    </m:msub>
                  </m:mtd>
                  <m:mtd>
                    <m:mo>⋯</m:mo>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:msub>
                      <m:mi>π</m:mi>
                      <m:mi>m</m:mi>
                    </m:msub>
                  </m:mtd>
                </m:mtr>
              </m:mtable>
            </m:mfenced>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id354400">Each row of <m:math overflow="scroll"><m:mstyle scriptlevel="0" displaystyle="true"><m:mrow><m:msub><m:mi mathvariant="bold">P</m:mi><m:mn>0</m:mn></m:msub><m:mo>=</m:mo><m:munder><m:mo movablelimits="true" form="prefix">lim</m:mo><m:mi>n</m:mi></m:munder><m:msup><m:mi mathvariant="bold">P</m:mi><m:mi>n</m:mi></m:msup></m:mrow></m:mstyle></m:math> is the long run distribution
<m:math overflow="scroll"><m:mstyle scriptlevel="0" displaystyle="true"><m:mrow><m:mi>π</m:mi><m:mo>=</m:mo><m:munder><m:mo movablelimits="true" form="prefix">lim</m:mo><m:mi>n</m:mi></m:munder><m:mi>π</m:mi><m:mrow><m:mo>(</m:mo><m:mi>n</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mstyle></m:math>.</para>
      <para id="id354492"><emphasis effect="bold">Definition</emphasis>.  A distribution is <emphasis effect="bold">stationary</emphasis> iff</para>
      <equation id="id354506">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>π</m:mi>
            <m:mo>=</m:mo>
            <m:mi>π</m:mi>
            <m:mi mathvariant="bold">P</m:mi>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id354527">The result above may be stated by saying that the long-run distribution is
the stationary distribution. A generating function analysis
shows the convergence is exponential in the following sense</para>
      <equation id="id354534">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mrow>
              <m:mo>|</m:mo>
            </m:mrow>
            <m:msup>
              <m:mi mathvariant="bold">P</m:mi>
              <m:mi>n</m:mi>
            </m:msup>
            <m:mo>-</m:mo>
            <m:msub>
              <m:mi mathvariant="bold">P</m:mi>
              <m:mn>0</m:mn>
            </m:msub>
            <m:msup>
              <m:mrow>
                <m:mo>|</m:mo>
                <m:mo>≤</m:mo>
                <m:mi>a</m:mi>
                <m:mo>|</m:mo>
                <m:mi>λ</m:mi>
                <m:mo>|</m:mo>
              </m:mrow>
              <m:mi>n</m:mi>
            </m:msup>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id354588">where <m:math overflow="scroll"><m:mrow><m:mo>|</m:mo><m:mi>λ</m:mi><m:mo>|</m:mo></m:mrow></m:math> is the largest absolute value of the eigenvalues for <emphasis effect="bold">P</emphasis> other
than <m:math overflow="scroll"><m:mrow><m:mi>λ</m:mi><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow></m:math>.</para>


<example id="fs-id1968412">
      <title> The long run distribution for the inventory example</title>
      <para id="id354642">We use MATLAB to check the eigenvalues for the transition probability <emphasis effect="bold">P</emphasis> and
to obtain increasing powers of <emphasis effect="bold">P</emphasis>. The convergence process is readily evident.</para>
      <code id="id354669" display="block">P =
    0.0803    0.1839    0.3679    0.3679
    0.6321    0.3679         0         0
    0.2642    0.3679    0.3679         0
    0.0803    0.1839    0.3679    0.3679
E = abs(eig(P))
E =
   1.0000
   0.2602
   0.2602
   0.0000
   format long
N = E(2).^[4 8 12]
N = 0.00458242348096   0.00002099860496   0.00000009622450
&gt;&gt; P4 = P^4
P4 =
   0.28958568915950   0.28593792666752   0.26059678211310   0.16387960205989
   0.28156644866011   0.28479107531968   0.26746979455342   0.16617268146679
   0.28385952806702   0.28250048636032   0.26288737107246   0.17075261450021
   0.28958568915950   0.28593792666752   0.26059678211310   0.16387960205989
 
&gt;&gt; P8 = P^8
P8 =
   0.28580046500309   0.28471421248816   0.26315895715219   0.16632636535655
   0.28577030590344   0.28469190218618   0.26316681807503   0.16637097383535
   0.28581491438224   0.28471028095839   0.26314057837998   0.16633422627939
   0.28580046500309   0.28471421248816   0.26315895715219   0.16632636535655
 
&gt;&gt; P12 = P^12
P12 =
   0.28579560683438   0.28470680858266   0.26315641543927   0.16634116914369
   0.28579574073314   0.28470680714781   0.26315628010643   0.16634117201261
   0.28579574360207   0.28470687626748   0.26315634631961   0.16634103381085
   0.28579560683438   0.28470680858266   0.26315641543927   0.16634116914369
&gt;&gt; error4 = max(max(abs(P^16 - P4)))    % Use P^16 for P_0
error4 =  0.00441148012334              % Compare with 0.0045824...
&gt;&gt; error8 = max(max(abs(P^16 - P8)))
error8 = 2.984007206519035e-05          % Compare with  0.00002099
&gt;&gt; error12 = max(max(abs(P^16 - P12)))
error12 = 1.005660185959822e-07         % Compare with 0.00000009622450
</code>
      <para id="id355077">The convergence process is clear, and the agreement with the error is close
to the predicted. We have not determined the factor <emphasis effect="italics">a</emphasis>, and we have approximated
the long run matrix <emphasis effect="italics">P<sub>0</sub></emphasis> with <emphasis effect="italics">P<sup>16</sup></emphasis>.  This exhibits a <emphasis effect="italics">practical criterion</emphasis>
for sufficient convergence. If the rows of <emphasis effect="italics">P<sup>n</sup></emphasis> agree within acceptable precision,
then <emphasis effect="italics">n</emphasis> is sufficiently large. For example, if we consider agreement to four
decimal places sufficient, then</para>
      <code id="id355159" display="block">P10 = P^10
P10 =
    0.2858    0.2847    0.2632    0.1663
    0.2858    0.2847    0.2632    0.1663
    0.2858    0.2847    0.2632    0.1663
    0.2858    0.2847    0.2632    0.1663
</code>
      <para id="id355214">shows that <m:math overflow="scroll"><m:mrow><m:mi>n</m:mi><m:mo>=</m:mo><m:mn>10</m:mn></m:mrow></m:math> is quite sufficient.</para>
      </example></section>



    <section id="cid5">
      <title>Simulation of finite homogeneous Markov sequences</title>
      <para id="id355259">In the section, <link document="m23385">"The Quantile Function"</link>, the quantile function is used with a random number generator
to obtain a simple random sample from a given population distribution. In this
section, we adapt that procedure to the problem of simulating a trajectory for
a homogeneous Markov sequences with finite state space.
</para>     
     
 <list id="id355276" display="block" list-type="enumerated"> <title> Elements and terminology</title>
        <item id="uid15"><emphasis effect="bold">States and state numbers</emphasis>. We suppose there are <emphasis effect="italics">m</emphasis> states, usually carrying
a numerical value. For purposes of analysis and simulation, we number the states 1 through <emphasis effect="italics">m</emphasis>.
Computation is carried out with state numbers; if desired, these can be translated into
the actual state values after computation is completed.
</item>
        <item id="uid16"><emphasis effect="bold">Stages, transitions, period numbers, trajectories and time</emphasis>. We use the term stage and
period interchangeably. It is customary to number the periods or stages beginning with
zero for the initial stage. The <emphasis effect="italics">period number</emphasis> is the number of transitions to reach
that stage from the initial one. Zero transitions are required to reach the original stage (period
zero), one transition to reach the next (period one), two transitions to reach period two,
etc. We call the sequence of states encountered as the system evolves a <emphasis effect="italics">trajectory</emphasis> or
a <emphasis effect="italics">chain</emphasis>. The terms “sample path” or “realization of the process” are also used in
the literature. Now if the periods are of equal time length, the number of transitions is a
measure of the elapsed time since the chain originated. We find it convenient to refer to <emphasis effect="italics">time</emphasis>
in this fashion. At time <emphasis effect="italics">k</emphasis> the chain has reached the period numbered <emphasis effect="italics">k</emphasis>. The trajectory
is <m:math overflow="scroll"><m:mrow><m:mi>k</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:math> stages long, so time or period number is one less than the number of stages.
</item>
        <item id="uid17"><emphasis effect="bold">The transition matrix and the transition distributions</emphasis>. For each state, there
is a conditional transition probability distribution for the next state. These are
arranged in a <emphasis effect="italics">transition matrix</emphasis>. The <emphasis effect="italics">i</emphasis>th row consists of the transition distribution
for selecting the next-period state when the current state number is <emphasis effect="italics">i</emphasis>. The transition
matrix <emphasis effect="italics">P</emphasis> thus has nonnegative elements, with each row summing to one. Such a matrix
is known as a <emphasis effect="italics">stochastic matrix</emphasis>.
</item>
      </list>


    
    
      
      <list id="id355464" display="block" list-type="enumerated"><title>The fundamental simulation strategy</title><item id="uid18">A fundamental strategy for sampling from a given population distribution is developed
in the unit on the Quantile Function. If <emphasis effect="italics">Q</emphasis> is the quantile function for the
population distribution and <emphasis effect="italics">U</emphasis>
is a random variable distributed uniformly on the interval <m:math overflow="scroll"><m:mrow><m:mo>[</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mn>1</m:mn><m:mo>]</m:mo></m:mrow></m:math>, then <m:math overflow="scroll"><m:mrow><m:mi>X</m:mi><m:mo>=</m:mo><m:mi>Q</m:mi><m:mo>(</m:mo><m:mi>U</m:mi><m:mo>)</m:mo></m:mrow></m:math> has
the desired distribution. To obtain a sample from the uniform distribution use
a random number generator. This sample is “transformed” by the quantile
function into a sample from the desired distribution.
</item>
        <item id="uid19">For a homogeneous chain, if we are in state <emphasis effect="italics">k</emphasis>, we have a distribution for
selecting the next state. If we use the quantile function for that distribution and
a number produced by a random number generator, we make a selection of the next
state based on that distribution. A succession of these choices, with the selection
of the next state made in each case from the distribution for the current state,
constitutes a valid simulation of a trajectory.
</item>
      </list>
   
    
      <para id="fs-id8799806"><emphasis effect="bold"> Arrival times and recurrence times</emphasis></para>
      <para id="id355582">The basic simulation produces one or more trajectories of a specified length. Sometimes
we are interested in continuing until first arrival at (or visit to)
a specific target state or any one of a set of target states. The time (in transitions)
to reach a target state is one less than the number of stages in the trajectory which
begins with the initial state and ends with the target state reached.</para>
      <list id="id355589" display="block" list-type="bulleted">
        <item id="uid20">If the initial state is not in the target set, we speak of the <emphasis effect="italics">arrival time</emphasis>.
</item>
        <item id="uid21">If the initial state is in the target set, the arrival time would be zero. In this
case, we do not stop at zero but continue until the next visit to a target state (possibly
the same as the initial state). We call the number of transitions in this case the
<emphasis effect="italics">recurrence time</emphasis>.
</item>
        <item id="uid22">In some instances, it may be desirable to know the time to complete visits to a
prescribed number of the target states. Again there is a choice of treatment in the
case the initial set is in the target set.
</item>
      </list>

      <para id="id355644">
        <emphasis effect="bold">Data files</emphasis>
      </para>
      <para id="id355651">For use of MATLAB in simulation, we find it convenient to organize the appropriate data in
an m-file.</para>
      <list id="id355657" display="block" list-type="bulleted">
        <item id="uid23">In every case, we need the transition matrix <emphasis effect="italics">P</emphasis>. Its size indicates the number
of states (say by the length of any row or column).
</item>
        <item id="uid24">If the states are to have values other than the state numbers, these may be
included in the data file, although they may be added later, in response to a prompt.
</item>
        <item id="uid25">If long trajectories are to be produced, it may be desirable to determine
the fraction of times each state is realized. A comparison with the long-run
probabilities for the chain may be of interest. In this case, the data file may
contain the long-run probability distribution. Usually, this is obtained by
taking one row of a sufficiently large power of the transition matrix. This operation
may be performed after the data file is called for but before the simulation
procedure begins.
</item>
      </list>

      <para id="id355717">An example data file used to illustrate the various procedures is shown below.
These data were generated artificially and have no obvious interpretations in terms of a
specific systems to be modeled. However, they are sufficiently complex to provide nontrivial
illustrations of the simulation procedures.
</para>
      <code id="id355724" display="block">% file markovp1.m
% Artificial data for a Markov chain, used to
% illustrate the operation of the simulation procedures.
P = [0.050 0.011 0.155 0.155 0.213 0.087 0.119 0.190 0.008 0.012
     0.103 0.131 0.002 0.075 0.013 0.081 0.134 0.115 0.181 0.165
     0.103 0.018 0.128 0.081 0.137 0.180 0.149 0.051 0.009 0.144
     0.051 0.098 0.118 0.154 0.057 0.039 0.153 0.112 0.117 0.101
     0.016 0.143 0.200 0.062 0.099 0.175 0.108 0.054 0.062 0.081
     0.029 0.085 0.156 0.158 0.011 0.156 0.088 0.090 0.055 0.172
     0.110 0.059 0.020 0.212 0.016 0.113 0.086 0.062 0.204 0.118
     0.084 0.171 0.009 0.138 0.140 0.150 0.023 0.003 0.125 0.157
     0.105 0.123 0.121 0.167 0.149 0.040 0.051 0.059 0.086 0.099
     0.192 0.093 0.191 0.061 0.094 0.123 0.106 0.065 0.040 0.035];
states = 10:3:37;
PI = [0.0849 0.0905 0.1125 0.1268 0.0883 0.1141 ...
      0.1049 0.0806 0.0881 0.1093];         % Long-run distribution
</code>

      <para id="id355877">The largest absolute value of the eigenvalues (other than one) is 0.1716. Since
<m:math overflow="scroll"><m:mrow><m:mn>0</m:mn><m:mo>.</m:mo><m:msup><m:mn>1716</m:mn><m:mn>16</m:mn></m:msup><m:mo>≈</m:mo><m:mn>5</m:mn><m:mo>.</m:mo><m:mn>6</m:mn><m:mo>·</m:mo><m:msup><m:mn>10</m:mn><m:mrow><m:mo>-</m:mo><m:mn>13</m:mn></m:mrow></m:msup></m:mrow></m:math>, we take any row of <emphasis effect="italics">P<sup>16</sup></emphasis> as the
long-run probabilities. These are included in the matrix PI in the m-file, above.
The examples for the various procedures below use this set of artificial data, since the purpose
is to illustrate the operation of the procedures.</para>
     
 <para id="id355942">
        <emphasis effect="bold">The setup and the generating m-procedures</emphasis>
      </para>
      <para id="id355949">The m-procedure <emphasis effect="italics">chainset</emphasis> sets up for simulation of Markov chains. It prompts for input of
the transition matrix <emphasis effect="italics">P</emphasis>, the states (if different from the state numbers), the
long-run distribution (if available), and the set of target states if it is
desired to obtain arrival or recurrence times. The procedure determines the
number of states from the size of <emphasis effect="italics">P</emphasis> and calculates the information needed for
the quantile function. It then prompts for a call for one of the generating procedures.</para>
      <para id="id355981">The m-procedure <emphasis effect="italics">mchain</emphasis>, as do the other generating procedures below, assumes chainset
has been run, so that commonly used data are available in appropriate form. The procedure prompts
for the number of stages (length of the trajectory to be formed) and for the initial
state. When the trajectory is produced, the various states in the trajectory and
the fraction or relative frequency of each is displayed. If the long-run distribution
has been supplied by chainset, this distribution is included for comparison. In
the examples below, we reset the random number generator (set the “seed” to zero)
for purposes of comparison. However, in practice, it may be desirable to make
several runs without resetting the seed, to allow greater effective “randomness.”</para>

<example id="fs-id2967489">
      <code id="id356007" display="block">markovp1                              % Call for data
chainset                              % Call for setup procedure
Enter the transition matrix  P
Enter the states if not 1:ms  states  % Enter the states
States are
     1    10
     2    13
     3    16
     4    19
     5    22
     6    25
     7    28
     8    31
     9    34
    10    37
Enter the long-run probabilities  PI  % Enter the long-run distribution
Enter the set of target states [16 22 25]   % Not used with mchain
Call for for appropriate chain generating procedure
rand('seed',0)
mchain                                % Call for generating procedure
Enter the number n of stages   10000  % Note the trajectory length
Enter the initial state  16
     State     Frac       P0          % Statistics on the trajectory
   10.0000    0.0812    0.0849
   13.0000    0.0952    0.0905
   16.0000    0.1106    0.1125
   19.0000    0.1226    0.1268
   22.0000    0.0880    0.0883
   25.0000    0.1180    0.1141
   28.0000    0.1034    0.1049
   31.0000    0.0814    0.0806
   34.0000    0.0849    0.0881
   37.0000    0.1147    0.1093
To view the first part of the trajectory of states, call for TR
disp(TR')
     0     1     2     3     4     5     6     7     8     9    10
    16    16    10    28    34    37    16    25    37    10    13
</code>
      <para id="id356362">The fact that the fractions or <emphasis effect="italics">relative frequencies</emphasis> approximate the long-run
probabilities is an expression of a fundamental limit property of probability
theory. This limit property, which requires somewhat sophisticated technique to
establish, justifies a relative frequency interpretation of probability.</para>
      <para id="id356377">The procedure <emphasis effect="italics">arrival</emphasis> assumes the setup provided by chainset, including a set
<emphasis effect="italics">E</emphasis> of target states. The procedure prompts for the number <emphasis effect="italics">r</emphasis> of repetitions and the
initial state. Then it produces <emphasis effect="italics">r</emphasis> succesive trajectories, each starting
with the prescribed initial state and ending on one of the target states. The arrival
times vary from one run to the next. Various statistics are computed and displayed
or made available. In the single-run case (<m:math overflow="scroll"><m:mrow><m:mi>r</m:mi><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow></m:math>), the trajectory may be displayed.
An auxiliary procedure <emphasis effect="italics">plotdbn</emphasis> may be used in the multirun case to plot the
distribution of arrival times.</para>
</example>

<example id="fs-id3080032">
      <title>  Arrival time to a target set of states</title>
      <code id="id356445" display="block">rand('seed',0)
arrival                                  % Assumes chainset has been run, as above
Enter the number of repetitions  1       % Single run case
The target state set is:
    16    22    25
Enter the initial state  34              % Specified initial state
 The arrival time is 6                   % Data on trajectory
The state reached is 16
To view the trajectory of states, call for TR
disp(TR')                                % Optional call to view trajectory
      0     1     2     3     4     5     6
     34    13    10    28    34    37    16
rand('seed',0)
arrival
Enter the number of repetitions  1000    % Call for 1000 repetitions
The target state set is:
    16    22    25
Enter the initial state  34              % Specified initial state
 The result of 1000 repetitions is:      % Run data (see optional calls below)
Term state  Rel Freq   Av time
   16.0000    0.3310    3.3021
   22.0000    0.3840    3.2448
   25.0000    0.2850    4.3895
The average arrival time is 3.59
The standard deviation is 3.207
The minimum arrival time is 1
The maximum arrival time is 23
To view the distribution of arrival times, call for dbn
To plot the arrival time distribution, call for plotdbn
plotdbn                                 % See <link target-id="uid26"/>
</code>
      <figure id="uid26"><media id="uid26_media" alt="Figure two is a graph labeled, time distribution. Its horizontal axis is labeled time in number of transitions. Its vertical axis is labeled relative frequency. The values on the horizontal axis range from 0 to 25 in increments of 5. The values on the vertical axis range from 0 to 0.35 in increments of 0.05. The data plotted on the graph are a series of small circles following a consistent curved shape. The shape, or pattern, created by the small circles, would begin at approximately (1, 0.3), in the top-left side of the graph, and would move to the right with a strong negative slope, but would decrease at a decreasing rate until approximately (15, 0), where the shape would continue horizontally. Along this general shape, the small circles initially appear to be spread apart very far. There is one small circle for every horizontal value from 1 to 19, so as the slope of the general shape of the plotted circles becomes more horizontal, the circles begin to be plotted more closely. After the circle at approximately (19, 0), there is one final circle furthest to the right, located at approximately (23, 0).">
          <image mime-type="image/png" src="../../media/fig16_4_1.png" id="uid26_onlineimage" width="424"><!-- NOTE: attribute width changes image size online (pixels). original width is 424. --></image>
          <image for="pdf" mime-type="application/postscript" src="../../media/fig16_4_1.eps" id="uid26_printimage" print-width="4in">
            <!--NOTE: attribute width changes image size in printed PDF (if specified in .tex file)-->
          </image>
        </media>
        
      <caption>Time distribution for <link target-id="fs-id3080032"/>.</caption></figure>
      <para id="id356755">It would be difficult to establish analytically estimates of arrival times. The
simulation procedure gives a reasonable “feel” for these times and how they vary.</para>
      <para id="id356761">The procedure <emphasis effect="italics">recurrence</emphasis> is similar to the procedure arrival. If the initial
state is not in the target set, it behaves as does the procedure arrival and stops on the first
visit to the target set. However, if the initial state is in the target set, the
procedures are different. The procedure arrival stops with zero transitions, since
it senses that it has “arrived.”  We are usually interested in having at least
one transition– back to the same state or to another state in the target set.
We call these times <emphasis effect="italics">recurrence times</emphasis>.</para>
</example>

<example id="fs-id2492136">
      
      <code id="id356790" display="block">rand('seed',0)
recurrence
Enter the number of repititions  1
The target state set is:
     16     22     25
Enter the initial state  22
</code>
      
      <figure id="uid27"><media id="uid27_media" alt="Figure three is a graph labeled, time distribution. Its horizontal axis is labeled time in number of transitions. Its vertical axis is labeled relative frequency. The values on the horizontal axis range from 0 to 25 in increments of 2. The values on the vertical axis range from 0 to 0.35 in increments of 0.05. The data plotted on the graph are a series of small circles following a consistent curved shape. The shape, or pattern, created by the small circles, would begin at approximately (1, 0.34), in the top-left side of the graph, and would move to the right with a strong negative slope, but would decrease at a decreasing rate until approximately (12, 0.01), where the shape would continue horizontally. Along this general shape, the small circles initially appear to be spread apart very far. There is one small circle for every horizontal value from 1 to 18, so as the slope of the general shape of the plotted circles becomes more horizontal, the circles begin to be plotted more closely. After the circle at approximately (18, 0), there is one final circle furthest to the right, located at approximately (20, 0).">
          <image mime-type="image/png" src="../../media/fig16_4_2.png" id="uid27_onlineimage" width="424"><!-- NOTE: attribute width changes image size online (pixels). original width is 424. --></image>
          <image for="pdf" mime-type="application/postscript" src="../../media/fig16_4_2.eps" id="uid27_printimage" print-width="3.4in">
            <!--NOTE: attribute width changes image size in printed PDF (if specified in .tex file)-->
          </image>
        </media>
        
      <caption>Transition time distribution for <link target-id="fs-id2492136"/>.</caption></figure>
      <code id="id356870" display="block">The recurrence time is 1
The state reached is 16
To view the trajectory of state numbers, call for TR
disp(TR')    0     1
            22    16
recurrence
Enter the number of repititions  1000
The target state set is:
     16     22     25
Enter the initial state  25
The result of 1000 repetitions is:
Term state  Rel Freq   Av time
   16.0000    0.3680    2.8723
   22.0000    0.2120    4.6745
   25.0000    0.4200    3.1690
   The average recurrence time is 3.379
The standard deviation is 3.0902
The minimum recurrence time is 1
The maximum recurrence time is 20
To view the distribution of recurrence times, call for dbn
To plot the recurrence time distribution, call for plotdbn
% See <link target-id="uid27"/>
</code>
      </example>


      <para id="id357092">The procedure <emphasis effect="italics">kvis</emphasis> stops when a designated number <emphasis effect="italics">k</emphasis> of states are visited. If
<emphasis effect="italics">k</emphasis> is greater than the number of target states, or if no <emphasis effect="italics">k</emphasis>
is designated, the procedure stops when all have been visited.
For <m:math overflow="scroll"><m:mrow><m:mi>k</m:mi><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow></m:math>, the behavior is the same as arrival. However, that case is
better handled by the procedure arrival, which provides more statistics on the results.</para>
 
<example id="fs-id6489140">
      <code id="id357150" display="block">rand('seed',0)
kvis                % Assumes chainset has been run
Enter the number of repetitions  1
The target state set is:
     16     22     25
Enter the number of target states to visit  2
Enter the initial state  34
The time for completion is 7
To view the trajectory of states, call for TR
disp(TR')
      0     1     2     3     4     5     6     7
     34    13    10    28    34    37    16    25
rand('seed',0)
kvis
Enter the number of repetitions  100
The target state set is:
     16     22     25
Enter the number of target states to visit    % Default-- visit all three
Enter the initial state  31
The average completion time is 17.57
The standard deviation is 8.783
The minimum completion time is 5
The maximum completion time is 42
To view a detailed count, call for D.
The first column shows the various completion times;
the second column shows the numbers of trials yielding those times
</code>
      </example>

      <para id="id357423">The first goal of this somewhat sketchy introduction to Markov processes is to provide
a general setting which gives insight into the essential character and structure of such systems.
The important case of homogenous chains is introduced in such a way that their
algebraic structure appears as a logical consequence of the Markov propertiy. The general theory
is used to obtain some tools for formulating homogeneous chains in practical cases. Some
MATLAB tools for studying their behavior are applied to an
artificial example, which demonstrates their general usefulness in studying
many practical, applied problems.
</para>
    </section>
  </content>
</document>